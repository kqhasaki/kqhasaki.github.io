<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.6d254c5d4f50e7cd19b8.css" data-identity="gatsby-global-css">.modal-wrapper{align-items:center;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:rgba(0,0,0,.6);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;z-index:1000}.modal-content-wrapper::-webkit-scrollbar{width:0}.modal-content{background:var(--card-background-color);border:1px solid var(--card-background-border-color);border-radius:1rem;padding:1.5rem;position:relative;width:40rem}.modal-content-wrapper{max-height:70vh;min-height:50vh;overflow-y:auto;width:100%}.modal-closer{cursor:pointer;font-size:1.2rem;position:absolute;right:.8rem;top:.8rem}.modal-closer:hover{color:var(--blue)}.post-card-img{border-radius:12px;bottom:0;box-shadow:0 0 2px rgba(0,0,0,.06);height:200px;left:50%;-o-object-fit:cover;object-fit:cover;position:absolute;-webkit-transform:translate(-50%) rotate(-8deg);transform:translate(-50%) rotate(-8deg);transition:.2s;width:300px}.img-line{height:120px;margin-bottom:2rem;position:relative}.post-card{align-items:center;border:1px solid var(--card-background-border-color);border-radius:1.5rem;cursor:pointer;display:flex;flex-direction:column;justify-content:center;margin:140px auto 0;max-width:45rem;padding:1.5rem 2rem;transition:.2s}.post-card:hover{box-shadow:0 0 1rem var(--card-box-shadow)}.post-card:active{box-shadow:0 0 1.5rem var(--blue)}.post-card:hover .post-card-img{-webkit-transform:translate(-50%) rotate(0deg);transform:translate(-50%) rotate(0deg)}.post-card h2:after{background:var(--blue);content:"";display:block;height:2px;margin-left:auto;margin-right:auto;margin-top:10px;width:60px}.post-card-meta{background-color:var(--card-background-color);border:1px solid var(--card-background-border-color);border-radius:.5rem;font-size:.9rem;font-weight:300;margin:1rem 0 0;padding:.5rem 1rem}@media (max-width:500px){.post-card{padding:1.5rem .8rem}}.item-list{align-items:center;border-left:3px solid var(--blue);display:flex;flex-direction:column;justify-content:center;margin:0 auto 0 1rem}.item-list .item{margin:0;padding:1rem;position:relative;width:100%}.item:before{background-color:var(--blue);border-radius:50%;content:"";height:.8rem;left:-.5rem;position:absolute;top:2rem;transition:.2s;width:.8rem}.item:hover:before{-webkit-transform:scale(1.2);transform:scale(1.2)}.item-list .item-label{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:15px;font-weight:400}.item-list .item-content{padding-top:.5rem}.homepage-title{font-weight:700;margin:2rem 0 1rem}.item a{transition:.3s}.item a:hover{color:var(--font-color-highlight)}.messager{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:.5rem;box-shadow:0 0 .8rem var(--card-box-shadow);left:0;margin-left:auto;margin-right:auto;max-width:200px;padding:.5rem 1rem;position:fixed;right:0;text-align:center;top:1rem;-webkit-transform:scale(.2);transform:scale(.2);transition:.2s;z-index:999}.avatar{align-items:center;display:flex;flex-direction:row;height:8rem;justify-content:center}.avatar>img{border-radius:50%;box-shadow:0 0 4px rgba(0,0,0,.1);max-height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center center;object-position:center center;opacity:1;padding:.5rem;transition:none 0s ease 0s}.footer{border-top:1px solid var(--card-background-border-color);color:var(--font-color);display:flex;flex-direction:row;font-size:13px;justify-content:space-evenly;margin-top:10rem;padding:2rem 0 8rem;position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none}.footer .wrapper{align-items:flex-start;display:flex;flex-direction:column;font-family:sans-serif;padding-left:.5rem;padding-right:1rem;width:50%}h3,ul{width:100%}h3{color:var(--font-color);margin-bottom:8px}.footer p{line-height:1.2rem;margin:0;padding:.5rem 0}.footer span{color:var(--font-color);cursor:pointer;margin-right:12px}.wrapper li{padding:4px 0}.footer span:hover{color:var(--font-color-highlight)}@media (max-width:600px){.footer{flex-direction:column}.footer .wrapper{margin-bottom:1rem;width:100%}}:root{--deckgo-highlight-code-font-family:Menlo,Monaco,Consolas}@media (prefers-color-scheme:dark){body{--blue:#02bbff;--background-color:#202124;--background-color-transparent:rgba(0,0,0,.9);--font-color:#bdc1c6;--font-color-header:#eaeaea;--font-color-highlight:#efefef;--btn-color:#333;--card-background-color:#222;--quote-background-color:#242424;--font-color-quote:#bdcbdc;--card-background-border-color:#2a2a2a;--card-box-shadow:#333;--code-font-color:#e0e0e0;--code-background-color:hsla(0,0%,39%,.2);--code-border-color:hsla(0,0%,39%,.2);--code-block-background:rgba(0,0,0,.1);--navigator-hover-color:hsla(0,0%,100%,.1);--navigator-border-color:#222}}@media (prefers-color-scheme:light){body{--blue:#02bbff;--background-color:#fff;--background-color-transparent:hsla(0,0%,100%,.9);--font-color:#3c4043;--font-color-header:#3c4043;--btn-color:#fff;--card-background-color:#efefef;--card-background-border-color:#efefef;--quote-background-color:#eaf8ff;--font-color-highlight:#000;--font-color-quote:#4e7182;--card-box-shadow:rgba(0,0,0,.1);--code-font-color:#444;--code-background-color:rgba(255,229,100,.2);--code-border-color:rgba(255,229,100,.2);--code-block-background:#313131;--navigator-hover-color:rgba(0,0,0,.08);--navigator-border-color:#ddd}}.dark{--blue:#02bbff;--background-color:#202124;--background-color-transparent:rgba(0,0,0,.9);--font-color:#bdc1c6;--font-color-header:#eaeaea;--font-color-highlight:#efefef;--btn-color:#333;--card-background-color:#222;--quote-background-color:#242424;--font-color-quote:#bdcbdc;--card-background-border-color:#2a2a2a;--card-box-shadow:#333;--code-font-color:#e0e0e0;--code-background-color:hsla(0,0%,39%,.2);--code-border-color:hsla(0,0%,39%,.2);--code-block-background:rgba(0,0,0,.1);--navigator-hover-color:hsla(0,0%,100%,.1);--navigator-border-color:#222}.light{--blue:#02bbff;--background-color:#fff;--background-color-transparent:hsla(0,0%,100%,.9);--font-color:#3c4043;--font-color-header:#3c4043;--btn-color:#fff;--card-background-color:#efefef;--card-background-border-color:#efefef;--quote-background-color:#eaf8ff;--font-color-highlight:#000;--font-color-quote:#4e7182;--card-box-shadow:rgba(0,0,0,.1);--code-font-color:#444;--code-background-color:rgba(255,229,100,.2);--code-border-color:rgba(255,229,100,.2);--code-block-background:#313131;--navigator-hover-color:rgba(0,0,0,.08);--navigator-border-color:#ddd}body,html{background-color:var(--background-color);color:var(--font-color);font-family:Arial,Helvetica,sans-serif}a{color:inherit;text-decoration:none}*{-webkit-tap-highlight-color:rgba(0,0,0,0);border:none;box-sizing:border-box;list-style-type:none;margin:0;padding:0}ol{margin:.7rem 0}ol li{list-style-type:decimal;margin:.4rem 0 .4rem 2rem}p{-webkit-margin-before:1em;-webkit-margin-after:1em;-webkit-margin-start:0;-webkit-margin-end:0;display:block;line-height:1.7rem;margin-block-end:1em;margin-block-start:1em;margin-bottom:.7rem;margin-inline-end:0;margin-inline-start:0;margin-top:.7rem}::selection{background-color:var(--blue);color:#fff}body{word-wrap:break-word;font-kerning:normal;margin:0;padding:0}header{align-items:center;display:flex;flex-direction:row;justify-content:space-around;padding-bottom:0}header>.route-link{margin:0 1rem}header img{box-shadow:0 0 .2rem rgba(0,0,0,.5)}.base-wrapper{margin-left:auto;margin-right:auto;max-width:48rem;min-height:100%;padding:2.625rem 1.3125rem}.nav-link{align-items:center;color:var(--font-color);cursor:pointer;display:flex;flex-direction:column;font-size:2rem;justify-content:center;margin:0 1rem;min-width:3rem}.nav-link>img{border-radius:50%;height:2rem;-webkit-transform:scale(1.2);transform:scale(1.2)}.nav-link:hover{color:var(--blue);text-decoration:none}.nav-link:hover .link-label{-webkit-transform:scaleY(1);transform:scaleY(1)}.nav-link .link-label{bottom:-24px;display:block;font-size:.9rem;padding-top:6px;text-align:center;-webkit-transform:scaleY(0);transform:scaleY(0);transition:.2s;width:8rem}.link-active{color:var(--blue)}.article-body .article-title{font-size:2rem;font-weight:500;margin-bottom:1.5rem;text-align:center}.article-body strong{color:var(--font-color-highlight)}.article-meta{font-size:.9rem;margin:1rem auto 1.5rem;text-align:center}.article-meta>span{background-color:var(--card-background-color);border-radius:.5rem;font-weight:lighter;padding:.5rem 1rem}.article-body h1,h2,h3{cursor:pointer}.article-body h1{color:var(--font-color-header);font-size:2rem;font-weight:400;margin-bottom:1.8rem;margin-top:1.8rem}.article-body h1 code{font-size:1.6rem}.article-body h2{color:var(--font-color-header);font-weight:400;margin-bottom:1.6rem;margin-top:1.5rem}.article-body h2 code{font-size:1.2rem}.article-body h3{color:var(--font-color-header);font-weight:400;line-height:1.8;margin-bottom:.5rem;margin-top:1.5rem}.article-body h3 code{font-size:1.1rem}.article-body h4{color:var(--font-color-header);font-weight:300;margin-bottom:1rem;margin-top:1.5rem}.article-body h4 code{font-size:1rem}.article-body h1:first-child{border-radius:.5rem}.article-body h1:not(:first-child):before{margin-bottom:.5rem}.article-body h1:not(:first-child):before,.article-body h2:before{background:var(--blue);content:"";display:block;height:2px;width:70px}.article-body h2:before{margin-bottom:.3rem}.article-body h3:before{background:var(--blue);content:"";display:block;height:1.5px;margin-top:.1rem;width:54px}.article-body code{background-color:var(--code-background-color);border:1px solid var(--code-border-color);border-radius:4px;color:var(--code-font-color);font-family:Menlo,Monaco,Consolas,monospace;font-size:14px;margin:0 2px;padding:1px 4px}.article-body blockquote{background-color:var(--quote-background-color);border-left:2px solid var(--blue);border-radius:0 .5rem .5rem 0;color:var(--font-color-quote);margin-top:1rem;padding:1rem}.article-body blockquote code{color:var(--font-color-highlight)}.article-body .article-cover{border-radius:16px;box-shadow:0 0 1px rgba(0,0,0,.1);width:80%}.article-body .article-cover,.article-body img{display:block;margin:0 auto;min-width:330px;-o-object-fit:cover;object-fit:cover}.article-body img{border-radius:12px;width:100%}.article-body ul{margin:.7rem 0}.article-body ul li{list-style-type:disc;margin:.4rem 0 .4rem 2rem}.article-body a{color:#189fff}a:hover{text-decoration:underline}.article-body a:after{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSIgY2xhc3M9InByZWZpeF9faWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCI+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0iTTkyNC40MDIgMTAyMy4wNjhILjY4Vjk5LjM0NUg0NjIuNTR2OTguOTFIOTkuNTk3VjkyNC4xNWg3MjUuODk2VjU2MS4yMDdoOTguOTF6Ii8+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0ibTkzMC44MDUgMjIuOTc3IDY5Ljk2NiA2OS45NjYtNDUzLjQ5MyA0NTMuNDkyLTY5Ljk2NS02OS45MDF6Ii8+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0iTTEwMjIuNDY0IDMwNC4wM2gtOTguOTE3Vjk5LjM0NUg3MDkuMjMxVi40MjhoMzEzLjIzM3oiLz48L3N2Zz4=);padding-left:2px}.article-body table{word-wrap:normal;border-collapse:collapse;table-layout:fixed;width:100%}th{background-color:rgba(0,0,0,.06);text-align:center}td{background-color:hsla(0,0%,100%,.01);font-weight:300}table,td,th{border:1px solid rgba(0,0,0,.1);overflow:auto;padding:.5rem}.theme-changer{border-radius:50%;bottom:1rem;cursor:pointer;position:fixed;right:1rem}.theme-changer img{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;height:30px;padding:6px;width:30px}deckgo-highlight-code{background-color:var(--code-block-background);border-radius:.5rem;box-shadow:none!important;cursor:pointer;font-size:14px;margin-top:1rem;position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none}@media (min-width:500px){deckgo-highlight-code:after{content:"åŒå‡»å¤åˆ¶";font-size:12px;height:2rem;opacity:0;position:absolute;right:1rem;text-align:center;top:1rem;transition:.4s;width:3rem}deckgo-highlight-code:hover:after{opacity:1}}.progresser{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;color:var(--font-color);cursor:pointer;font-family:Courier New,Courier,monospace;font-size:13px;font-weight:lighter;height:30px;line-height:29px;position:fixed;right:1rem;text-align:center;top:1rem;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:30px;z-index:999}.progresser:after{background-color:var(--quote-background-color);border-radius:50%;content:"";opacity:0;transition:.2s}.progresser:after,.progresser:hover:after{bottom:0;left:0;position:absolute;right:0;top:0}.progresser:hover:after{content:"up";opacity:1}.table-of-content{background-color:var(--background-color);border-left:1px solid var(--card-background-border-color);font-size:15px;height:95%;left:50%;overflow-y:auto;padding:1.5rem 1.5rem 3.5rem;position:fixed;top:50%;-webkit-transform:translateX(25rem) translateY(-50%);transform:translateX(25rem) translateY(-50%);-webkit-user-select:none;-ms-user-select:none;user-select:none;width:280px}@media (max-width:810px){.table-of-content{display:none}}.table-of-content::-webkit-scrollbar{display:none}.table-of-content p{cursor:pointer;margin:0;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.table-of-content .topHeader{color:var(--blue)!important}.table-of-content p:hover{color:var(--blue)}p.header-level-h1{margin-top:.5rem}p.header-level-h2{font-size:14px;padding-left:1rem}p.header-level-h3{font-size:13px;padding-left:2rem}.article-navigator{background-color:var(--background-color);border-right:1px solid var(--card-background-border-color);font-size:15px;height:95%;overflow-y:auto;padding:1.5rem 1.5rem 3.5rem;position:fixed;right:50%;top:50%;-webkit-transform:translateX(-25rem) translateY(-50%);transform:translateX(-25rem) translateY(-50%);-webkit-user-select:none;-ms-user-select:none;user-select:none;width:280px;z-index:999}.article-navigator .article-navigator-toggler{cursor:pointer;font-size:1.3rem;height:2rem;line-height:2rem;position:absolute;right:0;top:1rem;visibility:hidden;width:2rem}.article-navigator .article-navigator-toggler:hover{color:var(--blue)}@media (max-width:810px){.article-navigator{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background-color:var(--background-color-transparent);border:none;display:none;height:100%;left:0;padding:0;-webkit-transform:translateX(0) translateY(-50%);transform:translateX(0) translateY(-50%);width:100vw}.article-navigator h4{font-size:1.2rem!important;margin-top:1rem!important;padding-left:1rem;padding-right:1rem}.article-navigator p{border-bottom:1px solid var(--navigator-border-color);font-size:1rem!important;line-height:2.8rem!important;padding-left:2rem!important;padding-right:2rem!important;transition:background .3s}.article-navigator p:hover{background:var(--navigator-hover-color)}.navigator-switch{display:block}.article-navigator .article-navigator-toggler{visibility:visible}}.article-navigator h4{font-size:15px;margin-bottom:.5rem;margin-top:1rem}.article-navigator h4:first-child{margin-top:0}.navigator-switch{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;color:var(--font-color);cursor:pointer;display:none;font-size:.8rem;height:30px;left:1rem;line-height:29px;position:fixed;text-align:center;top:1rem;width:30px;z-index:999}.article-navigator p{cursor:pointer;font-size:14px;margin:0;overflow-x:hidden;padding-left:.5rem;text-overflow:ellipsis;white-space:nowrap;width:100%}.article-navigator p:hover,.highlighted-navigator-item{color:var(--blue)}</style><meta name="generator" content="Gatsby 4.4.0"/><link as="script" rel="preload" href="/webpack-runtime-2728ac9e468d19f28ba9.js"/><link as="script" rel="preload" href="/framework-f27b074ecebec0f1dbc4.js"/><link as="script" rel="preload" href="/app-e932af7f93db5f1d5fc7.js"/><link as="script" rel="preload" href="/cb1608f2-31c90b1bb67e245cb538.js"/><link as="script" rel="preload" href="/a9a7754c-992c6b2080a7db331a45.js"/><link as="script" rel="preload" href="/commons-9cb01ae01e0bbefcc23a.js"/><link as="script" rel="preload" href="/component---src-pages-articles-mdx-slug-js-9153719145713b5d4a70.js"/><link as="fetch" rel="preload" href="/page-data/articles/redbook-series/redbook-chapter20/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2757060725.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3605573801.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="base-wrapper"><title>Louis K - Software Engineer</title><header><a class="nav-link" href="/nonTech"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="book" class="svg-inline--fa fa-book " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M448 336v-288C448 21.49 426.5 0 400 0H96C42.98 0 0 42.98 0 96v320c0 53.02 42.98 96 96 96h320c17.67 0 32-14.33 32-31.1c0-11.72-6.607-21.52-16-27.1v-81.36C441.8 362.8 448 350.2 448 336zM143.1 128h192C344.8 128 352 135.2 352 144C352 152.8 344.8 160 336 160H143.1C135.2 160 128 152.8 128 144C128 135.2 135.2 128 143.1 128zM143.1 192h192C344.8 192 352 199.2 352 208C352 216.8 344.8 224 336 224H143.1C135.2 224 128 216.8 128 208C128 199.2 135.2 192 143.1 192zM384 448H96c-17.67 0-32-14.33-32-32c0-17.67 14.33-32 32-32h288V448z"></path></svg><span class="link-label">æ‚è°ˆæ–‡ç« </span></a><a class="nav-link" href="/"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="laptop-code" class="svg-inline--fa fa-laptop-code " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M128 96h384v256h64V80C576 53.63 554.4 32 528 32h-416C85.63 32 64 53.63 64 80V352h64V96zM624 384h-608C7.25 384 0 391.3 0 400V416c0 35.25 28.75 64 64 64h512c35.25 0 64-28.75 64-64v-16C640 391.3 632.8 384 624 384zM365.9 286.2C369.8 290.1 374.9 292 380 292s10.23-1.938 14.14-5.844l48-48c7.812-7.813 7.812-20.5 0-28.31l-48-48c-7.812-7.813-20.47-7.813-28.28 0c-7.812 7.813-7.812 20.5 0 28.31l33.86 33.84l-33.86 33.84C358 265.7 358 278.4 365.9 286.2zM274.1 161.9c-7.812-7.813-20.47-7.813-28.28 0l-48 48c-7.812 7.813-7.812 20.5 0 28.31l48 48C249.8 290.1 254.9 292 260 292s10.23-1.938 14.14-5.844c7.812-7.813 7.812-20.5 0-28.31L240.3 224l33.86-33.84C281.1 182.4 281.1 169.7 274.1 161.9z"></path></svg><span class="link-label">æŠ€æœ¯æ–‡ç« </span></a><div class="nav-link"><img alt="avatar" src="/static/avatar-427bcc9e4a03334af5649168991c08f0.png"/><span class="link-label">å…³äºä½œè€…</span></div></header><main><div class="progresser">0</div><div class="article-body"><h1 class="article-title">çº¢å®ä¹¦ç³»åˆ—ï¼ˆäºŒåï¼‰JavaScript API</h1><p class="article-meta"><span><span role="img" aria-label="field-time" class="anticon anticon-field-time"><svg viewBox="64 64 896 896" focusable="false" data-icon="field-time" width="1em" height="1em" fill="currentColor" aria-hidden="true"><defs><style></style></defs><path d="M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"></path><path d="M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"></path></svg></span> <!-- -->2022-03-10<!-- --> | <span role="img" aria-label="read" class="anticon anticon-read"><svg viewBox="64 64 896 896" focusable="false" data-icon="read" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M928 161H699.2c-49.1 0-97.1 14.1-138.4 40.7L512 233l-48.8-31.3A255.2 255.2 0 00324.8 161H96c-17.7 0-32 14.3-32 32v568c0 17.7 14.3 32 32 32h228.8c49.1 0 97.1 14.1 138.4 40.7l44.4 28.6c1.3.8 2.8 1.3 4.3 1.3s3-.4 4.3-1.3l44.4-28.6C602 807.1 650.1 793 699.2 793H928c17.7 0 32-14.3 32-32V193c0-17.7-14.3-32-32-32zM324.8 721H136V233h188.8c35.4 0 69.8 10.1 99.5 29.2l48.8 31.3 6.9 4.5v462c-47.6-25.6-100.8-39-155.2-39zm563.2 0H699.2c-54.4 0-107.6 13.4-155.2 39V298l6.9-4.5 48.8-31.3c29.7-19.1 64.1-29.2 99.5-29.2H888v488zM396.9 361H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm223.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c0-4.1-3.2-7.5-7.1-7.5H627.1c-3.9 0-7.1 3.4-7.1 7.5zM396.9 501H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm416 0H627.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5z"></path></svg></span> <!-- -->5000<!-- -->words <!-- -->18<!-- -->min</span></p><img class="article-cover" src="https://tva1.sinaimg.cn/large/008i3skNgy1gy6bw9bv2hj30jg0oo40x.jpg" alt="https://tva1.sinaimg.cn/large/008i3skNgy1gy6bw9bv2hj30jg0oo40x.jpg"/><p>éšç€ Web æµè§ˆå™¨èƒ½åŠ›çš„å¢åŠ ï¼Œå…¶å¤æ‚æ€§ä¹Ÿåœ¨è¿…é€Ÿå¢åŠ ã€‚ä»å¾ˆå¤šæ–¹é¢æ¥çœ‹ï¼Œç°ä»£ Web æµè§ˆå™¨å·²ç»æˆä¸ºæ„å»ºäºè¯¸å¤šè§„èŒƒä¹‹ä¸Šã€é›†ä¸åŒ API äºä¸€èº«çš„â€œç‘å£«å†›åˆ€â€ã€‚æµè§ˆå™¨è§„èŒƒçš„ç”Ÿæ€åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯æ··ä¹±è€Œæ— åºçš„ã€‚ä¸€äº›è§„èŒƒå¦‚ HTML5ï¼Œå®šä¹‰äº†ä¸€æ‰¹å¢å¼ºå·²æœ‰æ ‡å‡†çš„ API å’Œæµè§ˆå™¨ç‰¹æ€§ã€‚è€Œå¦ä¸€äº›è§„èŒƒå¦‚ Web Cryptography API å’Œ Notifications APIï¼Œåªä¸ºä¸€ä¸ªç‰¹æ€§å®šä¹‰äº†ä¸€ä¸ª APIã€‚ä¸åŒæµè§ˆå™¨å®ç°è¿™äº›æ–° API çš„æƒ…å†µä¹Ÿä¸åŒï¼Œæœ‰çš„ä¼šå®ç°å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œæœ‰çš„åˆ™å¹²è„†å°šæœªå®ç°ã€‚</p><p>æœ€ç»ˆï¼Œæ˜¯å¦ä½¿ç”¨è¿™äº›æ¯”è¾ƒæ–°çš„ API è¿˜æ˜¯è¦çœ‹é¡¹ç›®æ˜¯æ”¯æŒæ›´å¤šæµè§ˆå™¨ï¼Œè¿˜æ˜¯è¦é‡‡ç”¨æ›´å¤šç°ä»£ç‰¹æ€§ã€‚æœ‰äº› API å¯ä»¥ä½¿ç”¨è…»å­è„šæœ¬ï¼ˆpolyfillï¼‰æ¥æ¨¡æ‹Ÿï¼Œä½†æ˜¯è…»å­è„šæœ¬é€šå¸¸ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼Œæ­¤å¤–ä¹Ÿä¼šå¢åŠ ç½‘ç«™ JavaScript ä»£ç çš„ä½“ç§¯ã€‚</p><p>Web API çš„æ•°é‡ä¹‹å¤šä»¤äººéš¾ä»¥ç½®ä¿¡ã€‚æœ¬ç« è¦ä»‹ç»çš„ API ä»…é™äºä¸å¤§å¤šæ•°å¼€å‘è€…æœ‰å…³ã€å·²ç»å¾—åˆ°å¤šä¸ªæµè§ˆå™¨æ”¯æŒçš„éƒ¨åˆ†ã€‚</p><h1>Atomics å’Œ<code>SharedArrayBuffer</code></h1><p>å¤šä¸ªä¸Šä¸‹æ–‡è®¿é—®<code>SharedArrayBuffer</code>æ—¶ï¼Œå¦‚æœåŒæ—¶å¯¹ç¼“å†²åŒºæ‰§è¡Œæ“ä½œï¼Œå°±å¯èƒ½å‡ºç°èµ„æºäº‰ç”¨é—®é¢˜ã€‚Atomics API é€šè¿‡å¼ºåˆ¶åŒä¸€æ—¶åˆ»åªèƒ½å¯¹ç¼“å†²åŒºæ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œå¯ä»¥è®©å¤šä¸ªä¸Šä¸‹æ–‡å®‰å…¨åœ°è¯»å†™ä¸€ä¸ª<code>SharedArrayBuffer</code>ã€‚Atomics API æ˜¯ ES2017 ä¸­å®šä¹‰çš„ã€‚</p><p>ä»”ç»†ç ”ç©¶ä¼šå‘ç° Atomics API éå¸¸åƒä¸€ä¸ªç®€åŒ–ç‰ˆçš„æŒ‡ä»¤é›†æ¶æ„ï¼ˆISAï¼‰ï¼Œè¿™å¹¶éæ„å¤–ã€‚åŸå­æ“ä½œçš„æœ¬è´¨ä¼šæ’æ–¥æ“ä½œç³»ç»Ÿæˆ–è®¡ç®—æœºç¡¬ä»¶é€šå¸¸ä¼šè‡ªåŠ¨æ‰§è¡Œçš„ä¼˜åŒ–ï¼ˆä¾‹å¦‚æŒ‡ä»¤é‡æ–°æ’åºï¼‰ã€‚åŸå­æ“ä½œä¹Ÿè®©å¹¶å‘è®¿é—®å†…å­˜å˜å¾—ä¸å¯èƒ½ï¼Œå¦‚æœåº”ç”¨ä¸å½“å°±å¯èƒ½å¯¼è‡´ç¨‹åºæ‰§è¡Œå˜æ…¢ã€‚å› æ­¤ï¼ŒAtomics API çš„è®¾è®¡åˆè¡·æ˜¯åœ¨æœ€å°‘ä½†å¾ˆç¨³å®šçš„åŸå­è¡Œä¸ºåŸºç¡€ä¹‹ä¸Šï¼Œæ„å»ºå¤æ‚çš„å¤šçº¿ç¨‹ JavaScript ç¨‹åºã€‚</p><h2><code>SharedArrayBuffer</code></h2><p><code>SharedArrayBuffer</code>å’Œ<code>ArrayBuffer</code>å…·æœ‰åŒæ ·çš„ APIã€‚äºŒè€…çš„ä¸»è¦åŒºåˆ«æ˜¯<code>ArrayBuffer</code>å¿…é¡»åœ¨ä¸åŒçš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¹‹é—´åˆ‡æ¢ï¼Œ<code>SharedArrayBuffer</code>åˆ™å¯ä»¥è¢«ä»»æ„å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡åŒæ—¶ä½¿ç”¨ã€‚</p><p>åœ¨å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡é—´å…±äº«å†…å­˜æ„å‘³ç€å¹¶å‘çº¿ç¨‹æ“ä½œæˆä¸ºäº†å¯èƒ½ã€‚ä¼ ç»Ÿ JavaScript æ“ä½œå¯¹äºå¹¶å‘å†…å­˜è®¿é—®å¯¼è‡´çš„èµ„æºäº‰ç”¨æ²¡æœ‰æä¾›ä¿æŠ¤ã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº† 4 ä¸ªä¸“ç”¨å·¥ä½œçº¿ç¨‹è®¿é—®åŒä¸€ä¸ª<code>SharedArrayBuffer</code>å¯¼è‡´çš„èµ„æºäº‰ç”¨é—®é¢˜ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const workerScript = `
	self.onmessage = ({data}) =&gt; {
		const view = new Unit32Array(data)
		// æ‰§è¡Œ1000ï¼Œ000æ¬¡åŠ æ“ä½œ
		for (let i = 0; i &lt; 1e6; i++) {
			// çº¿ç¨‹ä¸åŠ å®‰å…¨æ“ä½œä¼šå¯¼è‡´èµ„æºäº‰ç”¨
			view[0] += 1
		}
		self.postMessage(null)
	}
`

const workerScriptBlobUrl = URL.createObjectURL(new Blob([workerScript]))

// åˆ›å»ºå®¹é‡ä¸º4çš„å·¥ä½œçº¿ç¨‹æ± 
const workers = []
for (let i = 0; i &lt; 4; i++) {
  workers.push(new Worker(workerScriptBlobUrl))
}
// åœ¨æœ€åä¸€ä¸ªå·¥ä½œçº¿ç¨‹å®Œæˆåæ‰“å°å‡ºæœ€ç»ˆå€¼
let responseCount = 0
for (const worker of workers) {
  worker.onmessage = () =&gt; {
    if (++responseCount === workers.length) {
      console.log(`Final buffer value: ${view[0]}`)
    }
  }
}

// åˆå§‹åŒ–SharedArrayBuffer
const sharedArrayBuffer = new SharedArrayBuffer(4)
const view = new Unit32Array(sharedArrayBuffer)
view[0] = 1

// æŠŠSharedArrayBufferå‘é€åˆ°æ¯ä¸ªå·¥ä½œçº¿ç¨‹
for (const worker of workers) {
  worker.postMessage(sharedArrayBuffer)
}

// æœŸå¾…çš„ç»“æœä¸º4000001ï¼Œç»“æœæ˜¯ä¸ç¬¦åˆçš„
// Final buffer value: 2145106</code>
        </deckgo-highlight-code><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒAtomics API åº”è¿è€Œç”Ÿã€‚Atomics API å¯ä»¥ä¿è¯<code>SharedArrayBuffer</code>ä¸Šçš„ JavaScript æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><h2>åŸå­æ“ä½œåŸºç¡€</h2><p>ä»»ä½•å…¨å±€ä¸Šä¸‹æ–‡ä¸­éƒ½æœ‰<code>Atomics</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸Šæš´éœ²äº†ç”¨äºæ‰§è¡Œçº¿ç¨‹å®‰å…¨æ“ä½œçš„ä¸€å¥—é™æ€æ–¹æ³•ï¼Œå…¶ä¸­å¤šæ•°æ–¹æ³•ä»¥ä¸€ä¸ª<code>TypedArray</code>å®ä¾‹ï¼ˆä¸€ä¸ª<code>SharedArrayBuffer</code>çš„å¼•ç”¨ï¼‰ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä»¥ç›¸å…³æ“ä½œæ•°ä½œä¸ºåç»­å‚æ•°ã€‚</p><h3>ç®—æœ¯åŠä½æ“ä½œæ–¹æ³•</h3><p>Atomics API æä¾›äº†ä¸€å¥—ç®€å•çš„æ–¹æ³•ç”¨ä»¥æ‰§è¡Œå°±åœ°ä¿®æ”¹æ“ä½œã€‚åœ¨ ECMA è§„èŒƒä¸­ï¼Œè¿™äº›æ–¹æ³•è¢«å®šä¹‰ä¸º<code>AtomicReadModifyWrite</code>æ“ä½œã€‚åœ¨åº•å±‚ï¼Œè¿™äº›æ–¹æ³•éƒ½ä¼šä»<code>SharedArrayBuffer</code>ä¸­æŸä¸ªä½ç½®è¯»å–å€¼ï¼Œç„¶åæ‰§è¡Œç®—æœ¯æˆ–ä½æ“ä½œï¼Œæœ€åå†æŠŠè®¡ç®—ç»“æœå†™å›ç›¸åŒçš„ä½ç½®ã€‚è¿™äº›æ“ä½œçš„åŸå­æœ¬è´¨æ„å‘³ç€ä¸Šè¿°è¯»å–ã€ä¿®æ”¹ã€å†™å›æ“ä½œä¼šæŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ã€‚</p><p>ä¸‹é¢ä»£ç æ¼”ç¤ºäº†æ‰€æœ‰ç®—æœ¯æ–¹æ³•ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">// åˆ›å»ºå¤§å°ä¸º1çš„ç¼“å†²åŒº
const sharedArrayBuffer = new SharedArrayBuffer(1)

// åŸºäºç¼“å†²åˆ›å»ºUnit8Array
const typedArray = new Unit8Array(sharedArrayBuffer)

// æ‰€æœ‰ArrayBufferå…¨éƒ½åˆå§‹åŒ–ä¸º0
console.log(typedArray) // Unit8Array[0]

const index = 0
const increment = 5

// å¯¹ç´¢å¼•0å¤„çš„å€¼æ‰§è¡ŒåŸå­åŠ 5
Atomics.add(typedArray, index, increment)

console.log(typedArray) // Unit8Array[5]

// å¯¹ç´¢å¼•0å¤„çš„å€¼æ‰§è¡ŒåŸå­å‡5
Atomics.sub(typedArray, index, increment)

console.log(typedArray) // Unit8Array[0]</code>
        </deckgo-highlight-code><p>ä¸‹é¢ä»£ç æ¼”ç¤ºäº†æ‰€æœ‰ä½æ–¹æ³•ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const sharedArrayBuffer = new SharedArrayBuffer(1)

const typedArray = new Unit8Array(sharedArrayBuffer)

console.log(typedArray) // Unit8Array[0]

const index = 0

// å¯¹ç´¢å¼•0å¤„çš„å€¼æ‰§è¡ŒåŸå­æˆ–0b1111
Atomics.or(typedArray, index, 0b1111)

console.log(typedArray) // Unit8Array[15]

// å¯¹ç´¢å¼•0å¤„çš„å€¼æ‰§è¡ŒåŸå­ä¸0b1111
Atomics.and(typedArray, index, 0b1111)

console.log(typedArray) // Unit8Array[12]

// å¯¹ç´¢å¼•0å¤„çš„å€¼æ‰§è¡ŒåŸå­å¼‚æˆ–0b1111
Atomics.xor(typedArray, index, 0b1111)

console.log(typedArray) // Unit8Array[3]</code>
        </deckgo-highlight-code><h3>åŸå­è¯»/å†™</h3><p>æµè§ˆå™¨çš„ JavaScript ç¼–è¯‘å™¨å’Œ CPU æ¶æ„æœ¬èº«éƒ½æœ‰æƒé™é‡æ’æŒ‡ä»¤ä»¥æå‡æ‰§è¡Œæ•ˆç‡ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒJavaScript çš„å•çº¿ç¨‹ç¯å¢ƒæ˜¯éšæ—¶å¯ä»¥è¿›è¡Œè¿™ç§ä¼˜åŒ–çš„ã€‚ä½†å¤šçº¿ç¨‹ç•™ä¸‹çš„æŒ‡ä»¤é‡æ’å¯èƒ½å¯¼è‡´èµ„æºäº‰ç”¨ï¼Œè€Œä¸”æéš¾æ‹é”™ã€‚</p><p>Atomics é€šè¿‡ä¸¤ç§ä¸»è¦æ–¹å¼è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><ul><li>æ‰€æœ‰åŸå­æŒ‡ä»¤ç›¸äº’ä¹‹é—´çš„é¡ºåºæ°¸è¿œä¸ä¼šé‡æ’</li><li>ä½¿ç”¨åŸå­è¯»æˆ–è€…åŸå­å†™ä¿è¯æ‰€æœ‰æŒ‡ä»¤ï¼ˆåŒ…æ‹¬åŸå­å’ŒéåŸå­æŒ‡ä»¤ï¼‰éƒ½ä¸ä¼šç›¸å¯¹åŸå­è¯»/å†™é‡æ–°æ’åºã€‚è¿™æ„å‘³ç€ä½äºåŸå­è¯»/å†™ä¹‹å‰çš„æ‰€æœ‰æŒ‡ä»¤ä¼šåœ¨åŸå­è¯»/å†™å‘ç”Ÿå‰å®Œæˆï¼Œè€Œä½äºåŸå­è¯»/å†™ä¹‹åçš„æ‰€æœ‰æŒ‡ä»¤ä¼šåœ¨åŸå­è¯»/å†™å®Œæˆåæ‰ä¼šå¼€å§‹ã€‚</li></ul><p>é™¤äº†è¯»å†™ç¼“å†²åŒºçš„å€¼ï¼Œ<code>Atomics.load()</code>å’Œ<code>Atomics.store()</code>è¿˜å¯ä»¥æ„å»ºâ€œä»£ç å›´æ â€ã€‚JavaScript å¼•æ“ä¿è¯éåŸå­æŒ‡ä»¤å¯ä»¥ç›¸å¯¹äº<code>load()</code>æˆ–<code>store()</code>æœ¬åœ°é‡æ’ã€‚ä½†è¿™ä¸ªé‡æ’ä¸ä¼šä¾µçŠ¯åŸå­è¯»/å†™çš„è¾¹ç•Œã€‚</p><h3>åŸå­äº¤æ¢</h3><p>ä¸ºäº†ä¿è¯è¿ç»­ã€ä¸é—´æ–­çš„å…ˆè¯»åå†™ï¼ŒAtomics API æä¾›äº†ä¸¤ç§æ–¹æ³•ï¼š <code>exchange()</code>å’Œ<code>compareExchange()</code>ã€‚<code>Atomics.exchange()</code>æ‰§è¡Œç®€å•çš„äº¤æ¢ï¼Œä»¥ä¿è¯å…¶ä»–çº¿ç¨‹ä¸ä¼šä¸­æ–­å€¼çš„äº¤æ¢ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const sharedArrayBuffer = new SharedArrayBuffer(4)
const view = new Unit32Array(sharedArrayBuffer)

Atomics.store(view, 0, 3)

console.log(Atomics.exchange(view, 0, 4)) // 3

console.log(Atomics.load(view, 0)) // 4</code>
        </deckgo-highlight-code><p>åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹å¯èƒ½<strong>åªå¸Œæœ›</strong>åœ¨ä¸Šæ¬¡è¯»å–æŸä¸ªå€¼ä¹‹åæ²¡æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹è¯¥å€¼çš„æƒ…å†µä¸‹æ‰å¯¹å…±äº«ç¼“å†²åŒºæ‰§è¡Œå†™æ“ä½œã€‚å¦‚æœè¿™ä¸ªå€¼æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œè¿™ä¸ªçº¿ç¨‹å°±å¯ä»¥å®‰å…¨åœ°å†™å…¥æ›´æ–°åçš„å€¼ï¼›å¦‚æœè¿™ä¸ªå€¼è¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆæ‰§è¡Œå†™æ“ä½œå°†ä¼šç ´åå…¶ä»–çº¿ç¨‹è®¡ç®—çš„å€¼ã€‚å¯¹äºè¿™ç§ä»»åŠ¡ï¼ŒAtomics API æä¾›äº†<code>compareExchange()</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•åªåœ¨ç›®æ ‡ç´¢å¼•å¤„çš„å€¼å’Œé¢„æœŸå€¼åŒ¹é…æ—¶æ‰ä¼šæ‰§è¡Œå†™æ“ä½œã€‚</p><h3>åŸå­ Futex æ“ä½œä¸æ·é”</h3><p>å¦‚æœæ²¡æœ‰æŸç§é”æœºåˆ¶ï¼Œå¤šçº¿ç¨‹ç¨‹åºå°±æ— æ³•æ”¯æŒå¤æ‚éœ€æ±‚ã€‚ä¸ºæ­¤ï¼ŒAtomics API æä¾›äº†æ¨¡ä»¿ Linux Futexï¼ˆå¿«é€Ÿç”¨æˆ·ç©ºé—´äº’æ–¥é‡ï¼Œfast user-space mutexï¼‰çš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æœ¬èº«è™½ç„¶éå¸¸ç®€å•ï¼Œä½†æ˜¯å¯ä»¥ä½œä¸ºæ›´å¤æ‚çš„é”æœºåˆ¶çš„åŸºæœ¬ç»„ä»¶ã€‚</p><h1>è·¨ä¸Šä¸‹æ–‡æ¶ˆæ¯</h1><p><strong>è·¨æ–‡æ¡£æ¶ˆæ¯</strong>ï¼Œæœ‰æ—¶å€™ç®€ç§°ä¸º XDMï¼ˆcross-document messaging)ï¼Œæ˜¯ä¸€ç§åœ¨ä¸åŒæ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆå¦‚ä¸åŒå·¥ä½œè€…çº¿ç¨‹æˆ–ä¸åŒæºçš„é¡µé¢ï¼‰é—´ä¼ é€’ä¿¡æ¯çš„èƒ½åŠ›ã€‚ä¾‹å¦‚<code>www.wrox.com</code>ä¸Šçš„é¡µé¢æƒ³è¦ä¸åŒ…å«åœ¨å†…åµŒçª—æ ¼ä¸­<code>p2p.wrox.com</code>ä¸Šé¢çš„é¡µé¢é€šä¿¡ã€‚åœ¨ XDM ä¹‹å‰ï¼Œè¦ä»¥å®‰å…¨æ–¹å¼å®ç°è¿™ç§é€šä¿¡éœ€è¦åšå¾ˆå¤šå·¥ä½œã€‚XDM ä»¥å®‰å…¨æ˜“ç”¨çš„æ–¹å¼è§„èŒƒåŒ–äº†è¿™ä¸ªåŠŸèƒ½ã€‚</p><blockquote><p>è·¨ä¸Šä¸‹æ–‡æ¶ˆæ¯ç”¨äºçª—å£ä¹‹é—´æˆ–è€…å·¥ä½œçº¿ç¨‹ä¹‹é—´é€šä¿¡ã€‚</p></blockquote><p>XDM çš„æ ¸å¿ƒæ˜¯<code>postMessage()</code>æ–¹æ³•ã€‚é™¤äº† XDMï¼Œè¿™ä¸ªæ–¹æ³•åè¿˜åœ¨ HTML5 ä¸­å¾ˆå¤šåœ°æ–¹ç”¨åˆ°è¿‡ï¼Œä½†ç›®çš„éƒ½æ˜¯ä¸€æ ·ï¼Œéƒ½æ˜¯æŠŠæ•°æ®ä¼ é€åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚</p><p><code>postMessage()</code>æ–¹æ³•æ¥æ”¶ 3 ä¸ªå‚æ•°ï¼šæ¶ˆæ¯ã€è¡¨ç¤ºç›®æ ‡æ¥æ”¶æºçš„å­—ç¬¦ä¸²å’Œå¯é€‰çš„å¯ä¼ è¾“å¯¹è±¡çš„æ•°ç»„ï¼ˆåªä¸å·¥ä½œçº¿ç¨‹ç›¸å…³ï¼‰ã€‚ç¬¬äºŒä¸ªå‚æ•°å¯¹äºå®‰å…¨éå¸¸é‡è¦ï¼Œå…¶å¯ä»¥é™åˆ¶æµè§ˆå™¨äº¤ä»˜æ•°æ®çš„ç›®æ ‡ã€‚ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const iframeWindow = document.getElementById(&#x27;myframe&#x27;).contentWindow

iframeWindow.postMessage(&#x27;A secret&#x27;, &#x27;http://www.wrox.com&#x27;)</code>
        </deckgo-highlight-code><p>æœ€åä¸€è¡Œä»£ç å°è¯•å‘å†…åµŒçª—æ ¼ä¸­å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œè€Œä¸”æŒ‡å®šäº†æºå¿…é¡»æ˜¯<code>&quot;http://www.wrox.com&quot;</code>ã€‚å¦‚æœæºåŒ¹é…ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°†ä¼šäº¤ä»˜åˆ°å†…åµŒçª—æ ¼ï¼›å¦åˆ™ï¼Œ<code>postMessage()</code>ä»€ä¹ˆä¹Ÿä¸åšã€‚è¿™ä¸ªé™åˆ¶å¯ä»¥ä¿æŠ¤ä¿¡æ¯ä¸ä¼šå› ä¸ºåœ°å€æ”¹å˜è€Œæ³„æ¼ã€‚å¦‚æœä¸æƒ³çŸ¥é™åˆ¶æ¥æ”¶ç›®æ ‡ï¼Œåˆ™å¯ä»¥ç»™<code>postMessage()</code>çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ <code>&quot;*&quot;</code>ï¼Œä½†ä¸æ¨èè¿™ä¹ˆåšã€‚</p><p>æ¥æ”¶åˆ° XDM æ¶ˆæ¯åï¼Œ<code>window</code>å¯¹è±¡ä¸Šè§¦å‘<code>message</code>äº‹ä»¶ã€‚è¿™ä¸ªäº‹ä»¶æ˜¯å¼‚æ­¥è§¦å‘çš„ï¼Œå› æ­¤ä»æ¶ˆæ¯å‘å‡ºåˆ°æ¥æ”¶åˆ°æ¶ˆæ¯ï¼ˆæ¥æ”¶çª—å£è§¦å‘<code>message</code>äº‹ä»¶ï¼‰å¯èƒ½æœ‰å»¶è¿Ÿã€‚ä¼ ç»™<code>onmessage</code>äº‹ä»¶å¤„ç†ç¨‹åºçš„<code>event</code>å¯¹è±¡åŒ…å«ä»¥ä¸‹ 3 æ–¹æ³•é‡è¦ä¿¡æ¯ï¼š</p><ul><li><code>data</code> ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™<code>postMessage()</code>çš„å­—ç¬¦ä¸²æ•°æ®</li><li><code>origin</code> å‘é€æ¶ˆæ¯çš„æ–‡æ¡£æºï¼Œä¾‹å¦‚<code>&quot;http://ww.wrox.com&quot;</code></li><li><code>source</code> å‘é€æ¶ˆæ¯çš„æ–‡æ¡£ä¸­<code>window</code>å¯¹è±¡çš„ä»£ç†ã€‚è¿™ä¸ªä»£ç†å¯¹è±¡ä¸»è¦ç”¨äºåœ¨å‘é€ä¸€æ¡æ¶ˆæ¯çš„çª—å£ä¸­æ‰§è¡Œ<code>postMessage()</code>æ–¹æ³•ã€‚å¦‚æœå‘é€çª—å£æœ‰ç›¸åŒçš„æºï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡åº”è¯¥å°±æ˜¯<code>window</code>å¯¹è±¡ã€‚</li></ul><p>æ¥æ”¶æ¶ˆæ¯ä¹‹åéªŒè¯å‘é€çª—å£çš„æºæ˜¯éå¸¸é‡è¦çš„ã€‚ä¸<code>postMessage()</code>çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¿è¯æ•°æ®ä¸å›æ„å¤–åœ°ä¼ ç»™æœªçŸ¥é¡µé¢ä¸€æ ·ã€‚åœ¨<code>onmessage</code>äº‹ä»¶å¤„ç†ç¨‹åºä¸­æ£€æŸ¥å‘é€çª—å£çš„æºå¯ä»¥ä¿è¯æ•°æ®æ¥è‡ªæ­£ç¡®çš„åœ°æ–¹ã€‚</p><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>event.source</code>æ˜¯æŸä¸ª<code>window</code>å¯¹è±¡çš„ä»£ç†ï¼Œè€Œéå®é™…çš„<code>window</code>å¯¹è±¡ã€‚å› æ­¤ä¸èƒ½é€šè¿‡å®ƒè®¿é—®æ‰€æœ‰çª—å£ä¸‹çš„ä¿¡æ¯ã€‚æœ€å¥½åªä½¿ç”¨<code>postMessage()</code>ï¼Œè¿™ä¸ªæ–¹æ³•æ°¸è¿œå­˜åœ¨ä¸”å¯ä»¥è°ƒç”¨ã€‚</p><p>åœ¨é€šè¿‡å†…åµŒçª—æ ¼åŠ è½½ä¸åŒçš„åŸŸæ—¶ï¼Œä½¿ç”¨ XDM æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚è¿™ç§æ–¹æ³•åœ¨æ··æ­<code>mashup</code>å’Œç¤¾äº¤åº”ç”¨ä¸­éå¸¸å¸¸ç”¨ã€‚é€šè¿‡ä½¿ç”¨ XDM ä¸å†…åµŒçª—æ ¼ä¸­çš„ç½‘é¡µé€šä¿¡ï¼Œå¯ä»¥ä¿è¯åŒ…å«é¡µé¢çš„å®‰å…¨ã€‚XDM ä¹Ÿå¯ä»¥ç”¨äºåŒæºé¡µé¢ä¹‹é—´çš„é€šä¿¡ã€‚</p><h1>Encodding API</h1><p>Encoding API ä¸»è¦ç”¨äºå®ç°å­—ç¬¦ä¸²ä¸å®šå‹æ•°ç»„ä¹‹é—´çš„è½¬æ¢ã€‚è§„èŒƒæ–°å¢äº† 4 ä¸ªç”¨äºæ‰§è¡Œè½¬æ¢çš„å…¨å±€ç±»ï¼š<code>TextEncoder</code>ã€<code>TextEncoderStream</code>ã€<code>TextDecoder</code>å’Œ<code>TextDecoderStream</code>ã€‚</p><blockquote><p>ç›¸æ¯”äº<strong>æ‰¹é‡ï¼ˆbulkï¼‰</strong>çš„ç¼–è§£ç ï¼Œå¯¹<strong>æµï¼ˆstreamï¼‰</strong>ç¼–è§£ç çš„æ”¯æŒå¾ˆæœ‰é™ã€‚</p></blockquote><h2>æ–‡æœ¬ç¼–ç </h2><p>Encoding API æä¾›äº†ä¸¤ç§å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå®šå‹æ•°ç»„äºŒè¿›åˆ¶æ ¼å¼çš„æ–¹æ³•ï¼šæ‰¹é‡ç¼–ç å’Œæµç¼–ç ã€‚æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå®šå‹æ•°ç»„æ—¶ï¼Œç¼–ç å™¨å§‹ç»ˆä½¿ç”¨ UTF-8ã€‚</p><h3>æ‰¹é‡ç¼–ç </h3><p>æ‰€è°“<strong>æ‰¹é‡</strong>ï¼ŒæŒ‡çš„æ˜¯ JavaScript å¼•æ“ä¼šåŒæ­¥ç¼–ç æ•´ä¸ªå­—ç¬¦ä¸²ã€‚å¯¹äºéå¸¸é•¿çš„å­—ç¬¦ä¸²ï¼Œå¯èƒ½ä¼šèŠ±è¾ƒé•¿æ—¶é—´ã€‚æ‰¹é‡ç¼–ç æ˜¯é€šè¿‡<code>TextEncoder</code>çš„å®ä¾‹å®Œæˆçš„ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textEncoder = new TextEncoder()</code>
        </deckgo-highlight-code><p>è¿™ä¸ªå®ä¾‹ä¸Šæœ‰ä¸€ä¸ª<code>encode()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå¹¶ä»¥<code>Unit8Array</code>æ ¼å¼è¿”å›æ¯ä¸ªå­—ç¬¦çš„ UTF-8 ç¼–ç ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textEncoder = new TextEncoder()
const decodedText = &#x27;foo&#x27;
const encodedText = textEncoder.encode(decodedText)

console.log(encodedText) // Unit8Array(3) [102, 111, 111]</code>
        </deckgo-highlight-code><p>ç¼–ç å™¨æ˜¯ç”¨äºå¤„ç†å­—ç¬¦çš„ï¼Œæœ‰äº›å­—ç¬¦ï¼ˆä¾‹å¦‚è¡¨æƒ…ç¬¦å·ï¼‰åœ¨æœ€ç»ˆè¿”å›çš„æ•°ç»„ä¸­å¯èƒ½ä¼šå æ®å¤šä¸ªç´¢å¼•ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textEncoder = new TextEncoder()
const decodedText = &#x27;â˜º&#x27;
const encodedText = textEncoder.encode(decodedText)

console.log(encodedText) // Unit8Array(3) [226, 152, 186]</code>
        </deckgo-highlight-code><p>ç¼–ç å™¨å®ä¾‹è¿˜æœ‰ä¸€ä¸ª<code>encodeInto()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å’Œç›®æ ‡<code>Unit8Array</code>ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸ï¼Œè¯¥å­—å…¸åŒ…å«<code>read</code>å’Œ<code>written</code>å±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤ºæˆåŠŸä»æºå­—ç¬¦ä¸²è¯»å–äº†å¤šå°‘å­—ç¬¦å’Œå‘ç›®æ ‡æ•°ç»„å†™å…¥äº†å¤šå°‘å­—ç¬¦ã€‚å¦‚æœå®šå‹æ•°ç»„çš„ç©ºé—´ä¸å¤Ÿï¼Œç¼–ç å°±ä¼šæå‰ç»ˆæ­¢ï¼Œè¿”å›çš„å­—å…¸ä¼šä½“ç°è¿™ä¸ªç»“æœã€‚</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textEncoder = new TextEncoder()
const fooArr = new Unit8Array(3)
const barArr = new Unit8Array(2)
const fooResult = textEncoder.encodeInto(&#x27;foo&#x27;, fooArr)
const barResult = textEncoder.encodeInto(&#x27;bar&#x27;, barArr)

console.log(foArr) // Unit8Array(3) [102, 111, 111]
console.log(fooResult) // { read: 3, written: 3 }
console.log(barArr) // Unit8Array(2) [98, 97]
console.log(barResult) // { read: 2, written: 2 }</code>
        </deckgo-highlight-code><p><code>encode()</code>è¦æ±‚åˆ†é…ä¸€ä¸ªæ–°çš„<code>Unit8Array</code>ï¼Œ<code>encodeInto()</code>åˆ™ä¸è¦ã€‚å¯¹äºè¿½æ±‚æ€§èƒ½çš„åº”ç”¨ï¼Œè¿™ä¸ªå·®åˆ«å¯èƒ½ä¼šå¸¦æ¥æ˜¾è‘—ä¸åŒã€‚</p><blockquote><p>æ–‡æœ¬ç¼–ç ä¼šå§‹ç»ˆä½¿ç”¨ UTF-8 æ ¼å¼ï¼Œè€Œä¸”å¿…é¡»å†™å…¥<code>Unit8Array</code>å®ä¾‹ã€‚ä½¿ç”¨å…¶ä»–ç±»å‹æ•°ç»„ä¼šå¯¼è‡´<code>encodeInto()</code>æŠ›å‡ºé”™è¯¯ã€‚</p></blockquote><h3>æµç¼–ç </h3><p><code>TextEncoderStream</code>å…¶å®å°±æ˜¯<code>TransformStream</code>å½¢å¼çš„<code>TextEncoder</code>ã€‚å°†è§£ç åçš„æ–‡æœ¬æµé€šè¿‡ç®¡é“è¾“å…¥æµç¼–ç å™¨ä¼šå¾—åˆ°ç¼–ç åæ–‡æœ¬å—çš„æµï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">async function* chars() {
  const decodeText = &#x27;foo&#x27;
  for (const char of decodeText) {
    yield await new Promise(resolve =&gt; setTimeout(resolve, 1000, char))
  }
}

const decodedTextStream = new ReadableStream({
  async start(controller) {
    for await (let chunk of chars()) {
      controller.enqueue(chunk)
    }

    controller.close()
  },
})

const encodedTextStream = decodedTextStream.pipeThrough(new TextEncoderStream())

const readableStreamDefaultReader = encodeTextStream.getReader()(
  async function () {
    while (true) {
      const { done, value } = await readableStreamDefaultReader.read()
      if (done) {
        break
      } else {
        console.log(value)
      }
    }
  }
)()

// Unit8Array [102]
// Unit8Array [111]
// Unit8Array [111]</code>
        </deckgo-highlight-code><h2>æ–‡æœ¬è§£ç </h2><p>Encoding API æä¾›äº†ä¸¤ç§å°†å®šå‹æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„æ–¹å¼ï¼šæ‰¹é‡è§£ç å’Œæµè§£ç ã€‚ä¸ç¼–ç å™¨ç±»ä¸åŒï¼Œåœ¨å°†å®šå‹æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œè§£ç å™¨æ”¯æŒéå¸¸å¤šçš„å­—ç¬¦ä¸²ç¼–ç ã€‚é»˜è®¤å­—ç¬¦ç¼–ç æ ¼å¼æ˜¯ UTF-8ã€‚</p><h3>æ‰¹é‡è§£ç </h3><p>æ‰€è°“<strong>æ‰¹é‡</strong>ï¼ŒæŒ‡çš„æ˜¯ JavaScript å¼•æ“ä¼šåŒæ­¥è§£ç æ•´ä¸ªå­—ç¬¦ä¸²ã€‚å¯¹äºéå¸¸é•¿çš„å­—ç¬¦ä¸²ï¼Œå¯èƒ½ä¼šèŠ±è¾ƒé•¿æ—¶é—´ã€‚æ‰¹é‡è§£ç æ˜¯é€šè¿‡<code>TextDecoder</code>çš„å®ä¾‹å®Œæˆçš„ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textDecoder = new TextDecoder()</code>
        </deckgo-highlight-code><p>è¿™ä¸ªå®ä¾‹ä¸Šæœ‰ä¸€ä¸ª<code>decode()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå®šå‹æ•°ç»„å‚æ•°ï¼Œè¿”å›è§£ç åçš„å­—ç¬¦ä¸²ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textDecoder = new TextDecoder()
const encodedText = Uint8Array.of(102, 111, 111)
const decodedText = textDecoder.decode(encodedText)

console.log(decodedText) // foo</code>
        </deckgo-highlight-code><p>è§£ç å™¨ä¸å…³å¿ƒä¼ å…¥çš„æ˜¯å“ªç§å®šå‹æ•°ç»„ï¼Œå®ƒåªä¼šä¸“å¿ƒè§£ç æ•´ä¸ªäºŒè¿›åˆ¶è¡¨ç¤ºã€‚åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåªåŒ…å« 8 ä½å­—ç¬¦çš„ 32 ä½å€¼è¢«è§£ç ä¸º UTF-8 æ ¼å¼ï¼Œè§£ç å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸­å¡«å……äº†ç©ºæ ¼ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textDecoder = new TextDecoder()

const encodedText = Uint32Array.of(102, 111, 111)
const decodedText = textDecoder.decode(encodedText)

console.log(decodedText) // &#x27;foo&#x27;</code>
        </deckgo-highlight-code><p>è§£ç å™¨æ˜¯ç”¨äºå¤„ç†å®šå‹æ•°ç»„ä¸­åˆ†æ•£åœ¨å¤šä¸ªç´¢å¼•ä¸Šçš„å­—ç¬¦çš„ï¼ŒåŒ…æ‹¬è¡¨æƒ…ç¬¦å·ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textDecoder = new TextDecoder()

const encodedText = Uint8Array.of(240, 159, 152, 138)
const decodedText = textDecoder.decode(encodedText)

console.log(decodedText) // &#x27;ğŸ˜Š&#x27;</code>
        </deckgo-highlight-code><p>å’Œ<code>TextEncoder</code>ä¸åŒï¼Œ<code>TextDecoder</code>å¯ä»¥å…¼å®¹å¾ˆå¤šå­—ç¬¦ç¼–ç ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­å°±ä½¿ç”¨äº† UTF-16 è€Œéé»˜è®¤çš„ UTF-8:</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const textDecoder = new TextDecoder(&#x27;utf-16&#x27;)

const encodedText = Uint16Array.of(102, 111, 111)
const decodedText = textDecoder.decode(encodedText)

console.log(decodedText) // &#x27;foo&#x27;</code>
        </deckgo-highlight-code><h3>æµè§£ç </h3><p><code>TextDecoderStream</code>å…¶å®å°±æ˜¯<code>TransformStream</code>å½¢å¼çš„<code>TextDecoder</code>ã€‚å°†ç¼–ç åçš„æ–‡æœ¬æµé€šè¿‡ç®¡é“è¾“å…¥æµè§£ç å™¨ä¼šå¾—åˆ°è§£ç åçš„æ–‡æœ¬å—çš„æµï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">async function* chars() {
  const encodedText = [102, 111, 111].map(x =&gt; Uint8Array.of(x))
  for (const char of encodedText) {
    yield await new Promise(resolve =&gt; setTimeout(resolve, 1000, char))
  }
}

const encodedTextStream = new ReadableStream({
  async start(controller) {
    for await (const chunk of chars()) {
      controller.enqueue(chunk)
    }

    controller.close()
  },
})

const decodedTextStream = encodedTextStream.pipeThrough(new TextDecoderStream())
const readableStreamDefaultReader = decodedTextStream.getReader()(
  async function () {
    while (true) {
      const { done, value } = await readableStreamDefaultReader.read()

      if (done) {
        break
      } else {
        console.log(value)
      }
    }
  }
)()

// f
// o
// o</code>
        </deckgo-highlight-code><p>æ–‡æœ¬è§£ç å™¨æµèƒ½å¤Ÿè¯†åˆ«å¯èƒ½åˆ†æ•£åœ¨ä¸åŒå—ä¸Šçš„ä»£ç†å¯¹ã€‚è§£ç å™¨æµä¼šä¿æŒå—ç‰‡æ®µç›´åˆ°å–å¾—å®Œæ•´çš„å­—ç¬¦ã€‚ä¾‹å¦‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæµè§£ç å™¨åœ¨è§£ç æµå¹¶è¾“å‡ºå­—ç¬¦ä¹‹å‰ä¼šç­‰å¾…ä¼ å…¥ 4 ä¸ªå—ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">async function* chars() {
  const encodedText = [240, 159, 152, 138].map(x =&gt; Uint8Array.of(x))

  for (const char of encodedText) {
    yield await new Promise(resolve =&gt; setTimeout(resolve, 1000, char))
  }
}

const encodedTextStream = new ReadableStream({
  async start(controller) {
    for await (const chunk of chars()) {
      controller.enqueue(chunk)
    }
    controller.close()
  },
})

const decodedTextStream = encodedTextStream.pipeThrough(new TextDecoderStream())

const readableStreamDefaultReader = decodeTextStream.getReader()(
  async function () {
    while (true) {
      const { done, value } = await readableStreamDefaultReader.read()

      if (done) {
        break
      } else {
        console.log(value)
      }
    }
  }
)()

// &#x27;ğŸ˜Š&#x27;</code>
        </deckgo-highlight-code><p>æ–‡æœ¬è§£ç å™¨æµç»å¸¸ä¸<code>fetch()</code>ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸ºå“åº”ä½“å¯ä»¥ä½œä¸º<code>ReadableStream</code>æ¥å¤„ç†ã€‚ä¾‹å¦‚ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const response = await fetch(url)
const stream = response.body.pipeThrough(new TextDecoderStream())
const decodedStream = stream.getReader()

for await (const decodedChunk of decodedStream) {
  console.log(decodedChunk)
}</code>
        </deckgo-highlight-code><h1>File API ä¸ Blob API</h1><p>Web åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªä¸»è¦ç—›ç‚¹æ˜¯æ— æ³•æ“ä½œç”¨æˆ·è®¡ç®—æœºä¸Šçš„æ–‡ä»¶ã€‚2000 å¹´ä¹‹å‰ï¼Œå¤„ç†æ–‡ä»¶çš„å”¯ä¸€æ–¹å¼æ˜¯æŠŠ<code>&lt;input type=&quot;file&quot;&gt;</code>æ”¾åˆ°ä¸€ä¸ªè¡¨å•é‡Œï¼Œä»…æ­¤è€Œå·²ã€‚File API ä¸ Blob API æ˜¯ä¸ºäº†è®© Web å¼€å‘è€…èƒ½ä»¥å®‰å…¨çš„æ–¹å¼è®¿é—®å®¢æˆ·ç«¯æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»è€Œæ›´å¥½åœ°ä¸è¿™äº›æ–‡ä»¶äº¤äº’è€Œè®¾è®¡çš„ã€‚</p><h2><code>File</code>ç±»å‹</h2><p><strong>File API ä»ç„¶ä»¥è¡¨å•ä¸­çš„æ–‡ä»¶è¾“å…¥å­—æ®µä¸ºåŸºç¡€</strong>ï¼Œä½†æ˜¯å¢åŠ äº†ç›´æ¥è®¿é—®æ–‡ä»¶ä¿¡æ¯çš„èƒ½åŠ›ã€‚HTML5 åœ¨ DOM ä¸Šä¸ºè¾“å…¥å…ƒç´ æ·»åŠ äº†<code>files</code>é›†åˆã€‚å½“ç”¨æˆ·åœ¨æ–‡ä»¶å­—æ®µä¸­é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œè¿™ä¸ª<code>file</code>é›†åˆä¸­ä¼šåŒ…å«ä¸€ç»„<code>File</code>å¯¹è±¡ï¼Œè¡¨ç¤ºè¢«é€‰ä¸­çš„æ–‡ä»¶ã€‚æ¯ä¸ª<code>File</code>å¯¹è±¡éƒ½æœ‰ä¸€äº›<strong>åªè¯»</strong>å±æ€§ã€‚</p><ul><li><code>name</code>ï¼šæœ¬åœ°ç³»ç»Ÿä¸­çš„æ–‡ä»¶å</li><li><code>size</code>ï¼šä»¥å­—èŠ‚è®¡ç®—çš„æ–‡ä»¶å¤§å°</li><li><code>type</code>ï¼šåŒ…å«æ–‡ä»¶ MIME ç±»å‹çš„å­—ç¬¦ä¸²</li><li><code>lastModifiedDate</code>ï¼šè¡¨ç¤ºæ–‡ä»¶æœ€åä¿®æ”¹äº‹ä»¶çš„å­—ç¬¦ä¸²ã€‚è¿™ä¸ªå±æ€§ç›®å‰åªæœ‰ Chrome å®ç°äº†ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œé€šè¿‡ç›‘å¬<code>change</code>äº‹ä»¶ç„¶åéå†<code>files</code>é›†åˆå¯ä»¥å–å¾—æ¯ä¸ªé€‰ä¸­æ–‡ä»¶çš„ä¿¡æ¯ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const fileList = document.getElementById(&#x27;files-list&#x27;)

filesList.addEventListener(&#x27;change&#x27;, event =&gt; {
  const files = event.target.files
  let i = 0
  while (i &lt; files.length) {
    const f = files[i]
    console.log(`${f.name}, ${f.type}, ${f.size} bytes`)
    i++
  }
})</code>
        </deckgo-highlight-code><p>è¿™ä¸ªä¾‹å­ç®€å•å°†æ¯ä¸ªæ–‡ä»¶çš„ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚ä»…å°±è¿™ä¸ªèƒ½åŠ›è€Œè¨€ï¼ŒWeb åº”ç”¨å·²ç»æ¯”æ²¡æœ‰ File API ä¹‹å‰è¿ˆè¿›äº†ä¸€å¤§æ­¥ã€‚ä¸è¿‡ï¼ŒFile API è¿˜æä¾›äº†<code>FileReader</code>ç±»å‹ï¼Œè®©æˆ‘ä»¬å¯ä»¥å®é™…ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚</p><h2><code>FileReader</code>ç±»å‹</h2><p><code>FileReader</code>ç±»å‹è¡¨ç¤ºä¸€ç§å¼‚æ­¥æ–‡ä»¶è¯»å–æœºåˆ¶ã€‚å¯ä»¥æŠŠ<code>FileReader</code>æƒ³è±¡æˆç±»ä¼¼äº<code>XMLHttpRequest</code>ï¼Œåªä¸è¿‡æ˜¯ç”¨äºä»æ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä»æœåŠ¡å™¨è¯»å–æ•°æ®ã€‚<code>FileReader</code>ç±»å‹æä¾›äº†å‡ ä¸ªè¯»å–æ–‡ä»¶æ•°æ®çš„æ–¹æ³•ã€‚</p><ul><li><code>readAsText(file, encoding)</code>ï¼šä»æ–‡ä»¶ä¸­è¯»å–çº¯æ–‡æœ¬å†…å®¹å¹¶ä¿å­˜åœ¨<code>result</code>å±æ€§ä¸­ã€‚ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºç¼–ç ï¼Œæ˜¯å¯é€‰çš„ã€‚</li><li><code>readAsDataURL(file)</code>ï¼šè¯»å–æ–‡ä»¶å¹¶å°†å†…å®¹çš„æ•°æ® URI ä¿å­˜åœ¨<code>result</code>å±æ€§ä¸­ã€‚</li><li><code>readAsBinaryString(file)</code>ï¼šè¯»å–æ–‡ä»¶å¹¶å°†æ¯ä¸ªå­—ç¬¦çš„äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åœ¨<code>result</code>å±æ€§ä¸­ã€‚</li><li><code>readAsArrayBuffer(file)</code>ï¼šè¯»å–æ–‡ä»¶å¹¶å°†æ–‡ä»¶å†…å®¹ä»¥<code>ArrayBuffer</code>å½¢å¼ä¿å­˜åœ¨<code>result</code>å±æ€§ã€‚</li></ul><p>è¿™äº›è¯»å–æ•°æ®çš„æ–¹æ³•ä¸ºå¤„ç†æ–‡ä»¶æ•°æ®æä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†å‘ç”¨æˆ·æ˜¾ç¤ºå›¾ç‰‡ï¼Œå¯ä»¥å°†å›¾ç‰‡æ•°æ®è¯»å–ä¸º URIï¼Œè€Œä¸ºäº†è§£ææ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥å°†æ–‡ä»¶è¯»å–ä¸ºæ–‡æœ¬ã€‚</p><p>å› ä¸ºè¿™äº›è¯»å–æ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥æ¯ä¸ª<code>FileReader</code>ä¼šå‘å¸ƒå‡ ä¸ªäº‹ä»¶ï¼Œå…¶ä¸­ 3 ä¸ªæœ€æœ‰ç”¨çš„äº‹ä»¶æ˜¯<code>progress</code>ã€<code>error</code>å’Œ<code>load</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºè¿˜æœ‰æ›´å¤šæ•°æ®ã€å‘ç”Ÿäº†é”™è¯¯å’Œè¯»å–å®Œæˆã€‚</p><p><code>progress</code>äº‹ä»¶æ¯ 50 æ¯«ç§’å°±ä¼šè§¦å‘ä¸€æ¬¡ï¼Œå’Œ XHR çš„<code>progress</code>äº‹ä»¶å…·æœ‰ç›¸åŒçš„ä¿¡æ¯ï¼š<code>lengthComputable</code>ã€<code>loaded</code>å’Œ<code>total</code>ã€‚æ­¤å¤–ï¼Œåœ¨<code>progress</code>äº‹ä»¶ä¸­å¯ä»¥è¯»å–<code>FileReader</code>çš„<code>result</code>å±æ€§ï¼Œå³ä½¿å…¶ä¸­å°šæœªåŒ…å«å…¨éƒ¨æ•°æ®ã€‚</p><p><code>error</code>äº‹ä»¶ä¼šåœ¨ç”±äºæŸç§åŸå› æ— æ³•è¯»å–æ–‡ä»¶æ—¶è§¦å‘ã€‚è§¦å‘<code>error</code>äº‹ä»¶æ—¶ï¼Œ<code>FileReader</code>çš„<code>error</code>å±æ€§ä¼šåŒ…å«é”™è¯¯ä¿¡æ¯ã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåªåŒ…å«ä¸€ä¸ªå±æ€§ï¼š<code>code</code>ã€‚è¿™ä¸ªé”™è¯¯ç çš„å€¼å¯èƒ½æ˜¯ 1ï¼ˆæœªæ‰¾åˆ°æ–‡ä»¶ï¼‰ã€2ï¼ˆå®‰å…¨é”™è¯¯ï¼‰ã€3ï¼ˆè¯»å–è¢«ä¸­æ–­ï¼‰ã€4ï¼ˆæ–‡ä»¶ä¸å¯è¯»ï¼‰æˆ– 5ï¼ˆç¼–ç é”™è¯¯ï¼‰ã€‚</p><p><code>load</code>äº‹ä»¶ä¼šåœ¨æ–‡ä»¶åŠ è½½æˆåŠŸåè§¦å‘ã€‚å¦‚æœ<code>error</code>äº‹ä»¶è¢«è§¦å‘ï¼Œåˆ™ä¸ä¼šå†è§¦å‘<code>load</code>äº‹ä»¶ã€‚</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const filesList = document.getElementById(&#x27;files-list&#x27;) 

filesList.addEventListener(&#x27;change&#x27;, event =&gt; {
  const info = &quot;&quot;
  const output = document.getElementById(&#x27;output&#x27;)
  const progress = document.getElementById(&#x27;progress&#x27;)
  const files = event.target.files
  const type = &#x27;default&#x27;
  const reader = new FileReader()
  
  if (/image/.test(files[0].type)) {
    reader.readAsDataURL(files[0])
    type = &#x27;image&#x27;
  } else {
    reader.readAsText(files[0])
    type = &#x27;text&#x27;
  }
  
  reader.onerror = function() {
    output.innerHTML = &#x27;Could not read file, error code is &#x27; + reader.error.code
  }
  
  reader.onprogress = function(event) {
    if (event.lengthComputable) {
      progress.innerHTML = `${event.loaded}/${event.total}`
    }
  }
  
  reader.onload = function() {
    let html = &#x27;&#x27;
    
    switch(type) {
      case &#x27;image&#x27;:
        html = `&lt;img src=&quot;${reader.result}&quot;&gt;`
        break
      case &#x27;text&#x27;:
        html = reader.result
        break
    }
    output.innerHTML = html
  }
})</code>
        </deckgo-highlight-code><p>ä»¥ä¸Šä»£ç ä»è¡¨å•å­—æ®µä¸­è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹æ˜¾ç¤ºåœ¨äº†ç½‘é¡µä¸Šã€‚å¦‚æœæ–‡ä»¶çš„MIMEç±»å‹è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œé‚£ä¹ˆå°±å°†å…¶è¯»å–åä¿å­˜ä¸ºæ•°æ®URLï¼Œåœ¨<code>load</code>äº‹ä»¶è§¦å‘æ—¶å°†æ•°æ®URIä½œä¸ºå›¾ç‰‡æ’å…¥é¡µé¢ä¸­ã€‚å¦‚æœæ–‡ä»¶ä¸æ˜¯å›¾ç‰‡ï¼Œåˆ™è¯»å–åå°†å…¶ä¿å­˜ä¸ºæ–‡æœ¬å¹¶åŸæ ·è¾“å‡ºåˆ°ç½‘é¡µä¸Šã€‚<code>progress</code>äº‹ä»¶ç”¨äºè·Ÿè¸ªå’Œæ˜¾ç¤ºè¯»å–æ–‡ä»¶çš„è¿›åº¦ï¼Œè€Œ<code>error</code>äº‹ä»¶ç”¨äºç›‘æ§é”™è¯¯ã€‚</p><p>å¦‚æœæƒ³æå‰ç»“æŸæ–‡ä»¶è¯»å–ï¼Œåˆ™å¯ä»¥åœ¨è¿‡ç¨‹ä¸­è°ƒç”¨<code>abort()</code>æ–¹æ³•ï¼Œä»è€Œè§¦å‘<code>abort</code>äº‹ä»¶ã€‚åœ¨<code>load</code>ã€<code>error</code>å’Œ<code>abort</code>äº‹ä»¶è§¦å‘åï¼Œè¿˜ä¼šè§¦å‘<code>loadend</code>äº‹ä»¶ã€‚<code>loadend</code>äº‹ä»¶è¡¨ç¤ºåœ¨ä¸Šè¿°3ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¯»å–æ“ä½œéƒ½å·²ç»“æŸã€‚<code>readAsText()</code>å’Œ<code>readAsDataURL()</code>æ–¹æ³•å·²ç»å¾—åˆ°äº†æ‰€æœ‰ä¸»æµæµè§ˆå™¨æ”¯æŒã€‚</p><h2><code>FileReaderSync</code>ç±»å‹</h2><p>é¡¾åæ€ä¹‰ï¼Œ<code>FileReaderSync</code>ç±»å‹å°±æ˜¯<code>FileReader</code>çš„<strong>åŒæ­¥ç‰ˆæœ¬</strong>ã€‚è¿™ä¸ªç±»å‹æ‹¥æœ‰ä¸<code>FileReader</code>ç›¸åŒçš„æ–¹æ³•ï¼Œåªæœ‰åœ¨æ•´ä¸ªæ–‡ä»¶éƒ½åŠ è½½åˆ°å†…å­˜ä¹‹åæ‰ä¼šç»§ç»­æ‰§è¡Œã€‚<code>FileReaderSync</code>åªåœ¨å·¥ä½œçº¿ç¨‹ä¸­å¯ç”¨ï¼Œå› ä¸ºå¦‚æœè¯»å–æ•´ä¸ªæ–‡ä»¶è€—æ—¶å¤ªé•¿åˆ™ä¼šå½±å“å…¨å±€ã€‚</p><p>å‡è®¾é€šè¿‡<code>postMessage()</code>å‘å·¥ä½œçº¿ç¨‹å‘é€äº†ä¸€ä¸ª<code>File</code>å¯¹è±¡ã€‚ä»¥ä¸‹ä»£ç ä¼šè®©å·¥ä½œçº¿ç¨‹åŒæ­¥å°†æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­ï¼Œç„¶åå°†æ–‡ä»¶çš„æ•°æ®URLå‘é€å›æ¥ã€‚</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">// worker.js

self.onmessage = messageEvent =&gt; {
  const syncReader = new FileReaderSync()
  console.log(syncReader) // FileReaderSync {}
  
  // è¯»å–æ–‡ä»¶æ—¶é˜»å¡å·¥ä½œçº¿ç¨‹
  const result = syncReader.readAsDataURL(messageEvent.data)
  
  // PDFæ–‡ä»¶çš„ç¤ºä¾‹å“åº”
  console.log(result) // data:application/pdf;base64,....
 	
  // æŠŠURLå‘å›å»
  self.postMessage(result)
}</code>
        </deckgo-highlight-code><h2><code>Blob</code>ä¸éƒ¨åˆ†è¯»å–</h2><p>æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦è¯»å–éƒ¨åˆ†æ–‡ä»¶è€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œ<code>File</code>å¯¹è±¡æä¾›äº†ä¸€ä¸ªåä¸º<code>slice()</code>çš„æ–¹æ³•ã€‚<code>slice()</code>æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šèµ·å§‹å­—èŠ‚å’Œè¦è¯»å–çš„å­—èŠ‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª<code>Blob</code>å®ä¾‹ï¼Œè€Œ<code>Blob</code>å®é™…ä¸Šæ˜¯<code>File</code>çš„åŸºç±»ã€‚</p><p>Blobè¡¨ç¤º<strong>äºŒè¿›åˆ¶å¤§å¯¹è±¡</strong>(binary large object)ï¼Œæ˜¯JavaScriptå¯¹ä¸å¯ä¿®æ”¹äºŒè¿›åˆ¶æ•°æ®çš„å°è£…ç±»å‹ã€‚åŒ…å«å­—ç¬¦ä¸²çš„æ•°ç»„ã€<code>ArrayBuffers</code>ã€<code>ArrayBufferViews</code>ï¼Œç”šè‡³å…¶ä»–<code>Blob</code>éƒ½å¯ä»¥ç”¨æ¥åˆ›å»ºblobã€‚<code>Blob</code>æ„é€ å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ª<code>options</code>å‚æ•°ï¼Œå¹¶åœ¨å…¶ä¸­æŒ‡å®šMIMEç±»å‹ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">console.log(new Blob([&#x27;foo&#x27;]))
// Blob {size: 3, type: &#x27;&#x27;}

console.log(new Blob([&#x27;{&quot;a&quot;, &quot;b&quot;}&#x27;], { type: &#x27;application/json&#x27; }))
// {size: 10, type: &quot;application/json&quot;}

console.log(new Blob([&#x27;&lt;p&gt;Foo&lt;/p&gt;&#x27;, &#x27;&lt;p&gt;Bar&lt;/p&gt;&#x27;], { type: &#x27;text/html&#x27; }))
// {size: 20, type: &#x27;text/html&#x27;}</code>
        </deckgo-highlight-code><p><code>Blob</code>å¯¹è±¡æœ‰ä¸€ä¸ª<code>size</code>å±æ€§å’Œä¸€ä¸ª<code>type</code>å±æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>slice()</code>æ–¹æ³•ç”¨äºè¿›ä¸€æ­¥åˆ‡åˆ†æ•°æ®ã€‚å¦å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨<code>FileReader</code>ä»<code>Blob</code>ä¸­è¯»å–æ•°æ®ã€‚ä¸‹é¢çš„ä¾‹å­åªä¼šè¯»å–æ–‡ä»¶çš„å‰32å­—èŠ‚ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const fileList = document.getElementById(&#x27;files-list&#x27;) 

filesList.addEventListener(&#x27;change&#x27;, event =&gt; {
  const info = &#x27;&#x27;
  const output = document.getElementById(&#x27;output&#x27;)
  const progress = document.getElementById(&#x27;progress&#x27;)
  const files = event.target.files
  const reader = new FileReader()
  const blob = blobSlice(files[0], 0, 32)
  
  if (blob) {
    reader.readAsText(blob)
    
    reader.onerror = function() {
      output.innerHTML = &#x27;Could not read file, error code is &#x27; + reader.error.code
    }
    
    reader.onload = function() {
      output.innerHTML = reader.result
    }
  } else {
    console.log(&#x27;You browser does not support slice()&#x27;)
  }
})</code>
        </deckgo-highlight-code><p>åªè¯»å–éƒ¨åˆ†æ–‡ä»¶å¯ä»¥èŠ‚çœæ—¶é—´ï¼Œç‰¹åˆ«æ˜¯åªéœ€è¦æ•°æ®ç‰¹å®šéƒ¨åˆ†ä¾‹å¦‚æ–‡ä»¶å¤´éƒ¨ã€‚</p><h2>å¯¹è±¡URLå’Œ<code>Blob</code></h2><p>å¯¹è±¡URLæœ‰æ—¶å€™ä¹Ÿç§°ä¸ºBlob URLï¼Œæ˜¯æŒ‡å¼•ç”¨å­˜å‚¨åœ¨<code>File</code>æˆ–<code>Blob</code>ä¸­æ•°æ®çš„URLã€‚å¯¹è±¡URLçš„ä¼˜ç‚¹æ˜¯ä¸ç”¨æŠŠæ–‡ä»¶å†…å®¹è¯»å–åˆ°JavaScriptä¹Ÿå¯ä»¥ä½¿ç”¨æ–‡ä»¶ã€‚åªè¦åœ¨é€‚å½“ä½ç½®æä¾›å¯¹è±¡URLå³å¯ã€‚è¦åˆ›å»ºå¯¹è±¡URLï¼Œå¯ä»¥ä½¿ç”¨<code>window.URL.createObjectURL()</code>æ–¹æ³•å¹¶ä¼ å…¥<code>File</code>æˆ–<code>Blob</code>å¯¹è±¡ã€‚è¿™ä¸ªå‡½æ•°è¿”å›çš„å€¼æ˜¯ä¸€ä¸ªæŒ‡å‘å†…å­˜ä¸­åœ°å€çš„å­—ç¬¦ä¸²ã€‚å› ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯URLï¼Œæ‰€ä»¥å¯ä»¥åœ¨DOMä¸­ç›´æ¥ä½¿ç”¨ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ä½¿ç”¨å¯¹è±¡URLåœ¨é¡µé¢ä¸­æ˜¾ç¤ºäº†ä¸€å¼ å›¾ç‰‡ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const filesList = document.getElementById(&#x27;files-list&#x27;)

filesList.addEventListener(&#x27;change&#x27;, event =&gt; {
  const info = &#x27;&#x27;
  const output = document.getElementById(&#x27;output&#x27;)
  const progress = document.getElementById(&#x27;progress&#x27;)
  const files = event.target.files
  const reader = new FileReader()
  const url = window.URL.createObjectURL(files[0])
  
  if (url) {
    if (/image/.test(files[0].type)) {
      output.innerHTML = `&lt;img src=&quot;${url}&quot;}&gt;`
    } else {
      output.innerHTML = &#x27;Not an image.&#x27;
    }
  } else {
    output.innerHTML = `Your browser doesn&#x27;t support object URLs.`
  }
})</code>
        </deckgo-highlight-code><p>å¦‚æœæŠŠå¯¹è±¡URLç›´æ¥æ”¾åˆ°<code>&lt;img&gt;</code>æ ‡ç­¾ï¼Œå°±ä¸è¦æŠŠæ•°æ®é¢„å…ˆè¯»å–åˆ°JavaScriptä¸­äº†ã€‚<code>&lt;img&gt;</code>æ ‡ç­¾å¯ä»¥ç›´æ¥ä»ç›¸åº”çš„å†…å­˜ä½ç½®æŠŠæ•°æ®è¯»å–åˆ°é¡µé¢ä¸Šã€‚</p><p>ä½¿ç”¨å®Œæ•°æ®åï¼Œæœ€å¥½èƒ½é‡Šæ”¾ä¸ä¹‹å…³è”çš„å†…å­˜ã€‚åªè¦å¯¹è±¡URLåœ¨ä½¿ç”¨ä¸­ï¼Œå°±ä¸èƒ½é‡Šæ”¾å†…å­˜ã€‚å¦‚æœæƒ³è¡¨æ˜ä¸å†ä½¿ç”¨æŸä¸ªå¯¹è±¡URLï¼Œåˆ™å¯ä»¥å°†å…¶ä¼ ç»™<code>window.URL.revokeObjectURL()</code>ã€‚é¡µé¢å¸è½½æ—¶ï¼Œæ‰€æœ‰å¯¹è±¡URLå ç”¨çš„å†…å­˜éƒ½ä¼šè¢«é‡Šæ”¾ã€‚ä¸è¿‡ï¼Œæœ€å¥½åœ¨ä¸ä½¿ç”¨æ—¶å°±ä¼šç«‹å³é‡Šæ”¾å†…å­˜ï¼Œä»¥ä¾¿å°½å¯èƒ½ä¿æŒé¡µé¢å ç”¨æœ€å°‘èµ„æºã€‚</p><h2>è¯»å–æ‹–æ”¾æ–‡ä»¶</h2><p>ç»„åˆä½¿ç”¨HTML5æ‹–æ”¾APIå’ŒFile APIå¯ä»¥åˆ›å»ºè¯»å–æ–‡ä»¶ä¿¡æ¯çš„æœ‰è¶£åŠŸèƒ½ã€‚åœ¨é¡µé¢ä¸Šåˆ›å»ºæ”¾ç½®ç›®æ ‡åï¼Œå¯ä»¥ä»æ¡Œé¢ä¸ŠæŠŠæ–‡ä»¶æ‹–åŠ¨å¹¶æ”¾åˆ°æ”¾ç½®ç›®æ ‡ã€‚è¿™æ ·ä¼šåƒæ‹–æ”¾å›¾ç‰‡æˆ–é“¾æ¥ä¸€æ ·è§¦å‘<code>drop</code>æ—¶é—´ã€‚è¢«æ”¾ç½®çš„æ–‡ä»¶å¯ä»¥é€šè¿‡æ—¶é—´çš„<code>event.dataTransfer.files</code>å±æ€§è¯»å–åˆ°ï¼Œè¿™ä¸ªå±æ€§ä¿å­˜ç€ä¸€ç»„<code>File</code>å¯¹è±¡ï¼Œå°±åƒæ–‡æœ¬è¾“å…¥å­—æ®µä¸€æ ·ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­ä¼šæŠŠæ‹–æ”¾åˆ°é¡µé¢æ”¾ç½®ç›®æ ‡ä¸Šçš„æ–‡ä»¶ä¿¡æ¯æ‰“å°å‡ºæ¥ï¼š</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const droptarget = document.getElementById(&#x27;droptarget&#x27;)

function handleEvent(event) {
  const info = &#x27;&#x27;
  const output = document.getElementById(&#x27;output&#x27;)
  let files, i, len
  event.preventDefault()
  
  if (event.type === &#x27;drop&#x27;) {
    files = event.dataTransfer.files
    i = 0
    len = files.length
    while (i &lt; len) {
      info += `${files[i].name} (${files[i].type}), ${files[i].size} bytes&lt;br&gt;`
      i++
    }
    
    output.innerHTML = info
  }
}

droptarget.addEventListener(&#x27;dragenter&#x27;, handleEvent)
droptarget.addEventListener(&#x27;dragover&#x27;, handleEvent) 
droptarget.addEventListener(&#x27;drop&#x27;, handleEvent)</code>
        </deckgo-highlight-code><p>ä¸åé¢è¦ä»‹ç»çš„æ‹–æ”¾ä¾‹å­ä¸€æ ·ï¼Œå¿…é¡»å–æ¶ˆ<code>dragenter</code>ã€<code>dragover</code>å’Œ<code>drop</code>çš„é»˜è®¤è¡Œä¸ºã€‚åœ¨<code>drop</code>äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œå¯ä»¥é€šè¿‡<code>event.dataTransfer.files</code>è¯»å–åˆ°æ–‡ä»¶ï¼Œæ­¤æ—¶å¯ä»¥è·å–æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ã€‚</p><h1>åª’ä½“å…ƒç´ </h1><p>éšç€åµŒå…¥éŸ³é¢‘å’Œè§†é¢‘å…ƒç´ åœ¨Webåº”ç”¨ä¸Šçš„æµè¡Œï¼Œå¤§å¤šæ•°å†…å®¹æä¾›å•†ä¼šå¼ºè¿«ä½¿ç”¨Flashä»¥ä¾¿è¾¾åˆ°æœ€ä½³çš„è·¨æµè§ˆå™¨å…¼å®¹æ€§ã€‚HTML5æ–°å¢äº†ä¸¤ä¸ªä¸åª’ä½“ç›¸å…³çš„å…ƒç´ ï¼Œå³<code>&lt;audio&gt;</code>å’Œ<code>&lt;video&gt;</code>ï¼Œä»è€Œä¸ºæµè§ˆå™¨æä¾›äº†åµŒå…¥éŸ³é¢‘å’Œè§†é¢‘çš„ç»Ÿä¸€è§£å†³æ–¹æ¡ˆã€‚</p><p>è¿™ä¸¤ä¸ªå…ƒç´ æ—¢æ”¯æŒWebå¼€å‘è€…åœ¨é¡µé¢ä¸­åµŒå…¥åª’ä½“æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒJavaScriptå®ç°å¯¹åª’ä½“çš„è‡ªå®šä¹‰æ§åˆ¶ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„ç”¨æ³•ï¼š</p><deckgo-highlight-code language="jsx" theme="one-dark">
          <code slot="code">&lt;!-- åµŒå…¥è§†é¢‘ --&gt; 
&lt;video src=&quot;conference.mpg&quot; id=&quot;myVideo&quot;&gt;Video player not available.&lt;/video&gt;
&lt;!-- åµŒå…¥éŸ³é¢‘ --&gt; 
&lt;audio src=&quot;song.mp3&quot; id=&quot;myAudio&quot;&gt;Audio player not available.&lt;/audio&gt;</code>
        </deckgo-highlight-code><p>æ¯ä¸ªå…ƒç´ è‡³å°‘è¦æ±‚æœ‰ä¸€ä¸ª<code>src</code>å±æ€§ï¼Œä»¥è¡¨ç¤ºè¦åŠ è½½çš„åª’ä½“æ–‡ä»¶ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šè¡¨ç¤ºè§†é¢‘æ’­æ”¾å™¨å¤§å°çš„<code>width</code>å’Œ<code>height</code>å±æ€§ï¼Œä»¥åŠåœ¨è§†å±åŠ è½½æœŸé—´æ˜¾ç¤ºå›¾ç‰‡URIçš„<code>poster</code>å±æ€§ã€‚å¦å¤–ï¼Œ<code>controls</code>å±æ€§å¦‚æœå­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºæµè§ˆå™¨åº”è¯¥æ˜¾ç¤ºæ’­æ”¾ç•Œé¢ï¼Œè®©ç”¨æˆ·å¯ä»¥ç›´æ¥æ§åˆ¶åª’ä½“ã€‚<strong>å¼€å§‹å’Œç»“æŸæ ‡ç­¾ä¹‹é—´çš„å†…å®¹æ˜¯åœ¨åª’ä½“æ’­æ”¾å™¨ä¸å¯ç”¨æ—¶æ˜¾ç¤ºçš„æ›¿ä»£å†…å®¹</strong>ã€‚</p><p>ç”±äºæµè§ˆå™¨æ”¯æŒçš„åª’ä½“æ ¼å¼ä¸åŒï¼Œå› æ­¤å¯ä»¥æŒ‡å®šå¤šä¸ªä¸åŒçš„åª’ä½“æºã€‚ä¸ºæ­¤éœ€è¦ä»å…ƒç´ ä¸­åˆ é™¤<code>src</code>å±æ€§ï¼Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª<code>&lt;source&gt;</code>å…ƒç´ ä»£æ›¿ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><deckgo-highlight-code language="jsx" theme="one-dark">
          <code slot="code">&lt;!-- åµŒå…¥è§†é¢‘ --&gt; 
&lt;video id=&quot;myVideo&quot;&gt;
  &lt;source src=&quot;conference.webm&quot; type=&quot;video/webm; codecs=&#x27;vp8, vorbis&#x27;&quot; /&gt;
  &lt;source src=&quot;conference.ogv&quot; type=&quot;video/ogg; codecs=&#x27;theora, vorbis&#x27;&quot; /&gt;
  &lt;source src=&quot;conference.mpg&quot; /&gt;
  Video Player not available.
&lt;/video&gt;

&lt;!-- åµŒå…¥éŸ³é¢‘ --&gt; 
&lt;audio id=&quot;myAudio&quot;&gt;
  &lt;source src=&quot;song.ogg&quot; type=&quot;audio/ogg&quot; /&gt;
  &lt;source src=&quot;song.mp3&quot; type=&quot;audio/mpeg&quot; /&gt;
  Audio Player not available.
&lt;/audio&gt;</code>
        </deckgo-highlight-code><p>è®¨è®ºä¸åŒéŸ³é¢‘å’Œè§†é¢‘çš„ç¼–è§£ç å™¨è¶…å‡ºäº†æœ¬ä¹¦èŒƒå›´ï¼Œä½†æµè§ˆå™¨æ”¯æŒçš„ç¼–è§£ç å™¨ç¡®å®å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œå› æ­¤æŒ‡å®šå¤šä¸ªæºæ–‡ä»¶é€šå¸¸æ˜¯å¿…é¡»çš„ã€‚</p><h2>å±æ€§</h2><p><code>&lt;video&gt;</code>å’Œ<code>&lt;audio&gt;</code>å…ƒç´ æä¾›äº†ç¨³å¥çš„JavaScriptæ¥å£ã€‚è¿™ä¸¤ä¸ªå…ƒç´ æœ‰å¾ˆå¤šå…±æœ‰å±æ€§ï¼Œå¯ä»¥ç”¨äºç¡®å®šåª’ä½“çš„å½“å‰çŠ¶æ€ã€‚</p><h2>äº‹ä»¶</h2><p>é™¤äº†æœ‰å¾ˆå¤šå±æ€§ï¼Œåª’ä½“å…ƒç´ è¿˜æœ‰å¾ˆå¤šäº‹ä»¶ã€‚è¿™äº›äº‹ä»¶ä¼šç›‘æ§ç”±äºåª’ä½“å›æ”¾æˆ–ç”¨æˆ·äº¤äº’å¯¼è‡´çš„ä¸åŒå±æ€§çš„å˜åŒ–ã€‚è¿™äº›äº‹ä»¶è¢«è®¾è®¡å¾—å°½å¯èƒ½å…·ä½“ï¼Œä»¥ä¾¿Webå¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨è¾ƒå°‘çš„HTMLå’ŒJavaScriptåˆ›å»ºè‡ªå®šä¹‰çš„éŸ³é¢‘/è§†é¢‘æ’­æ”¾å™¨ï¼ˆè€Œä¸æ˜¯åˆ›å»ºæ–°Flashå½±ç‰‡ï¼‰ã€‚</p><h2>è‡ªå®šä¹‰åª’ä½“æ’­æ”¾å™¨</h2><p>ä½¿ç”¨<code>&lt;audio&gt;</code>å’Œ<code>&lt;video&gt;</code>çš„<code>play()</code>å’Œ<code>pause()</code>æ–¹æ³•ï¼Œå¯ä»¥æ‰‹åŠ¨æ§åˆ¶åª’ä½“æ–‡ä»¶çš„æ’­æ”¾ã€‚ç»¼åˆä½¿ç”¨å±æ€§ã€äº‹ä»¶å’Œè¿™äº›æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºè‡ªå®šä¹‰çš„åª’ä½“æ’­æ”¾å™¨ã€‚ä¾‹å¦‚ä¸‹é¢ä¾‹å­ï¼š</p><deckgo-highlight-code language="jsx" theme="one-dark">
          <code slot="code">&lt;div class=&quot;mediaplayer&quot;&gt;
  &lt;div class=&quot;video&quot;&gt;
    &lt;video id=&quot;player&quot; src=&quot;movie.mov&quot; poster=&quot;mymovie.jpg&quot; width=&quot;300&quot; height=&quot;200&quot;&gt;
      Video player not available.
    &lt;/video&gt;
  &lt;/div&gt;
  &lt;div class=&quot;controls&quot;&gt;
    &lt;input type=&quot;button&quot; value=&quot;Play&quot; id=&quot;video-btn&quot; /&gt;
    &lt;span id=&quot;curtime&quot;&gt;0&lt;/span&gt;/&lt;span id=&quot;duration&quot;&gt;0&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;</code>
        </deckgo-highlight-code><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const player = document.getElementById(&#x27;player&#x27;)
const btn = document.getElementById(&#x27;video-btn&#x27;)
const curtime = document.getElementById(&#x27;curtime&#x27;)
const duration = document.getElementById(&#x27;duration&#x27;)

duration.innerHTML = player.duration

btn.addEventListener(&#x27;click&#x27;, event =&gt; {
  if (player.paused) {
    player.play()
    btn.value = &#x27;Pause&#x27;
  } else {
    player.pause()
    btn.value = &#x27;Play&#x27;
  }
})

setInterval(() =&gt; {
  curTime.innerHTML = player.currentTime
}, 250)</code>
        </deckgo-highlight-code><p>è¿™é‡Œçš„JavaScriptä»£ç ç®€å•åœ°ä¸ºæŒ‰é’®æ·»åŠ äº†äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¯ä»¥æ ¹æ®å½“å‰çŠ¶æ€æ’­æ”¾å’Œæš‚åœè§†é¢‘ã€‚æ­¤å¤–ï¼Œè¿˜ç»™<code>&lt;video&gt;</code>å…ƒç´ çš„<code>load</code>äº‹ä»¶æ·»åŠ äº†äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä»¥ä¾¿æ˜¾ç¤ºè§†é¢‘çš„æ—¶é•¿ã€‚æœ€åé‡å¤çš„è®¡æ—¶å™¨ç”¨äºæ›´æ–°å½“å‰æ—¶é—´ã€‚é€šè¿‡ç›‘å¬æ›´å¤šäº‹ä»¶ä»¥åŠä½¿ç”¨æ›´å¤šå±æ€§ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ‰©å±•è¿™ä¸ªè‡ªå®šä¹‰çš„è§†é¢‘æ’­æ”¾å™¨ã€‚åŒæ ·çš„ä»£ç ä¹Ÿå¯ä»¥ç”¨äº<code>&lt;audio&gt;</code>å…ƒç´ ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„éŸ³é¢‘æ’­æ”¾å™¨ã€‚</p><h2>æ£€æµ‹ç¼–è§£ç å™¨</h2><p>å¦‚å‰æ‰€è¿°ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒ<code>&lt;video&gt;</code>å’Œ<code>&lt;audio&gt;</code>çš„æ‰€æœ‰ç¼–è§£ç å™¨ï¼Œè¿™é€šå¸¸æ„å‘³ç€å¿…é¡»æä¾›å¤šä¸ªåª’ä½“æºã€‚ä¸ºæ­¤ï¼Œä¹Ÿæœ‰JavaScript APIå¯ä»¥ç”¨æ¥æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒç»™å®šæ ¼å¼å’Œç¼–è§£ç å™¨ã€‚è¿™ä¸¤ä¸ªåª’ä½“å…ƒç´ éƒ½æœ‰ä¸€ä¸ªåä¸º<code>canPlayType()</code>çš„æ–¹æ³•ï¼Œæ”¹æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ ¼å¼/ç¼–è§£ç å™¨å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼š<code>&quot;probably&quot;</code>ã€<code>&quot;maybe&quot;</code>æˆ–<code>&quot;&quot;</code>ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œå…¶ä¸­ç©ºå­—ç¬¦ä¸²å°±æ˜¯å‡å€¼ï¼Œæ„å‘³ç€å¯ä»¥åœ¨<code>if</code>è¯­å¥ä¸­åƒè¿™æ ·ä½¿ç”¨<code>canPlayType()</code>:</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">if (audio.canPlayType(&#x27;audio/mpeg&#x27;)) {
  // æ‰§è¡ŒæŸäº›æ“ä½œ
}</code>
        </deckgo-highlight-code><p><code>&quot;probably&quot;</code>å’Œ<code>&quot;maybe&quot;</code>éƒ½æ˜¯çœŸå€¼ï¼Œåœ¨<code>if</code>è¯­å¥çš„ä¸Šä¸‹æ–‡ä¸­å¯ä»¥è½¬å‹ä¸º<code>true</code>ã€‚</p><p>åœ¨åªç»™<code>canPlayType()</code>æä¾›ä¸€ä¸ªMIMEç±»å‹çš„æƒ…å†µä¸‹ï¼Œæœ€å¯èƒ½è¿”å›çš„å€¼æ˜¯<code>&quot;maybe&quot;</code>å’Œç©ºå­—ç¬¦ä¸²ã€‚è¿™æ˜¯å› ä¸ºæ–‡ä»¶å®é™…ä¸Šåªæ˜¯ä¸€ä¸ªåŒ…è£…éŸ³é¢‘å’Œè§†é¢‘æ•°æ®çš„å®¹å™¨ï¼Œè€ŒçœŸæ­£å†³å®šæ–‡ä»¶æ˜¯å¦å¯ä»¥æ’­æ”¾çš„æ˜¯ç¼–ç ã€‚åœ¨åŒæ—¶æä¾›MIMEç±»å‹å’Œç¼–è§£ç å™¨çš„æƒ…å†µä¸‹ï¼Œè¿”å›å€¼çš„å¯èƒ½æ€§ä¼šæé«˜åˆ°<code>probably</code>ã€‚</p><h2>éŸ³é¢‘ç±»å‹</h2><p><code>&lt;audio&gt;</code>å…ƒç´ è¿˜æœ‰ä¸€ä¸ªåä¸º<code>Audio</code>çš„åŸç”ŸJavaScriptæ„é€ å‡½æ•°ï¼Œæ”¯æŒåœ¨ä»»ä½•æ—¶å€™æ’­æ”¾éŸ³é¢‘ã€‚<code>Audio</code>ç±»å‹å’Œ<code>Image</code>ç±»ä¼¼ï¼Œéƒ½æ˜¯DOMå…ƒç´ çš„å¯¹ç­‰ä½“ï¼Œåªæ˜¯ä¸éœ€æ’å…¥æ–‡æ¡£å³å¯å·¥ä½œã€‚è¦é€šè¿‡<code>Audio</code>æ’­æ”¾éŸ³é¢‘ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹å¹¶ä¼ å…¥éŸ³é¢‘æºæ–‡ä»¶ï¼š</p><deckgo-highlight-code language="jsx" theme="one-dark">
          <code slot="code">const audio = new Audio(&#x27;sound.mp3&#x27;)
EventUtil.addHandler(audio, &#x27;canplaythrough&#x27;, function(event) {
  audio.play()
})</code>
        </deckgo-highlight-code><p>åˆ›å»º<code>Audio</code>çš„æ–°å®ä¾‹å°±ä¼šä¸‹è½½æŒ‡å®šçš„æ–‡ä»¶ã€‚ä¸‹è½½å®Œæ¯•ä¹‹åï¼Œå¯ä»¥è°ƒç”¨<code>play()</code>æ¥æ’­æ”¾éŸ³é¢‘ã€‚åœ¨iOSä¸­è°ƒç”¨<code>play()</code>æ–¹æ³•ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œè¯·æ±‚ç”¨æˆ·æˆæƒæ’­æ”¾å£°éŸ³ã€‚ä¸ºäº†è¿ç»­æ’­æ”¾ï¼Œå¿…é¡»åœ¨<code>onfinish</code>äº‹ä»¶å¤„ç†ç¨‹åºä¸­ç«‹å³è°ƒç”¨<code>play()</code>ã€‚</p></div><div class="navigator-switch" style="display:none"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="list" class="svg-inline--fa fa-list " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M88 48C101.3 48 112 58.75 112 72V120C112 133.3 101.3 144 88 144H40C26.75 144 16 133.3 16 120V72C16 58.75 26.75 48 40 48H88zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 232C16 218.7 26.75 208 40 208H88C101.3 208 112 218.7 112 232V280C112 293.3 101.3 304 88 304H40C26.75 304 16 293.3 16 280V232zM88 368C101.3 368 112 378.7 112 392V440C112 453.3 101.3 464 88 464H40C26.75 464 16 453.3 16 440V392C16 378.7 26.75 368 40 368H88z"></path></svg></div><div class="article-navigator" style="display:block"><div class="article-navigator-toggler"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path></svg></div><h4>å‰ç«¯æ‚è°ˆ</h4><p title="è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰" class="">è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰</p><p title="æ¸²æŸ“é¡µé¢ï¼šæµè§ˆå™¨çš„å·¥ä½œåŸç†" class="">æ¸²æŸ“é¡µé¢ï¼šæµè§ˆå™¨çš„å·¥ä½œåŸç†</p><p title="React diffingç®—æ³•" class="">React diffingç®—æ³•</p><p title="Vercelç®€ä»‹ é™æ€åšå®¢éƒ¨ç½²" class="">Vercelç®€ä»‹ é™æ€åšå®¢éƒ¨ç½²</p><h4>æŠ„ä¹¦ç³»åˆ—â€”â€”ã€Šç®—æ³•å¯¼è®ºã€‹</h4><p title="ç®—æ³•å¯¼è®ºç³»åˆ—ï¼ˆä¸€ï¼‰ç¿»å¼€ã€Šç®—æ³•å¯¼è®ºã€‹" class="">ç®—æ³•å¯¼è®ºç³»åˆ—ï¼ˆä¸€ï¼‰ç¿»å¼€ã€Šç®—æ³•å¯¼è®ºã€‹</p><p title="ç®—æ³•å¯¼è®ºç³»åˆ—ï¼ˆäºŒï¼‰ç®—æ³•åœ¨è®¡ç®—ä¸­çš„ä½œç”¨" class="">ç®—æ³•å¯¼è®ºç³»åˆ—ï¼ˆäºŒï¼‰ç®—æ³•åœ¨è®¡ç®—ä¸­çš„ä½œç”¨</p><h4>æŠ„ä¹¦ç³»åˆ—â€”â€”â€œçº¢å®ä¹¦â€</h4><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆä¸€ï¼‰ä»€ä¹ˆæ˜¯JavaScriptï¼Ÿ" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆä¸€ï¼‰ä»€ä¹ˆæ˜¯JavaScriptï¼Ÿ</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆäºŒï¼‰HTMLä¸­çš„JavaScript" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆäºŒï¼‰HTMLä¸­çš„JavaScript</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆä¸‰ï¼‰JavaScriptè¯­è¨€åŸºç¡€" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆä¸‰ï¼‰JavaScriptè¯­è¨€åŸºç¡€</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆå…­ï¼‰é›†åˆå¼•ç”¨ç±»å‹" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆå…­ï¼‰é›†åˆå¼•ç”¨ç±»å‹</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆä¸ƒï¼‰è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆä¸ƒï¼‰è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆåä¸€ï¼‰æœŸçº¦ä¸å¼‚æ­¥å‡½æ•°" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆåä¸€ï¼‰æœŸçº¦ä¸å¼‚æ­¥å‡½æ•°</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆåå››ï¼‰DOM" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆåå››ï¼‰DOM</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆåäº”ï¼‰DOMæ‰©å±•" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆåäº”ï¼‰DOMæ‰©å±•</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆåä¸ƒï¼‰äº‹ä»¶" class="">çº¢å®ä¹¦ç³»åˆ—ï¼ˆåä¸ƒï¼‰äº‹ä»¶</p><p title="çº¢å®ä¹¦ç³»åˆ—ï¼ˆäºŒåï¼‰JavaScript API" class="highlighted-navigator-item">çº¢å®ä¹¦ç³»åˆ—ï¼ˆäºŒåï¼‰JavaScript API</p></div>0</main><footer class="footer"><div class="wrapper"><p style="font-size:1.3rem"><span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="weixin" class="svg-inline--fa fa-weixin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M385.2 167.6c6.4 0 12.6 .3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2 .1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3 .1 10-9.9 19.6-24.4 19.6z"></path></svg></span><span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="qq" class="svg-inline--fa fa-qq " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433.8 420.4c-11.53 1.393-44.86-52.74-44.86-52.74 0 31.34-16.14 72.25-51.05 101.8 16.84 5.192 54.84 19.17 45.8 34.42-7.316 12.34-125.5 7.881-159.6 4.037-34.12 3.844-152.3 8.306-159.6-4.037-9.045-15.25 28.92-29.21 45.78-34.42-34.92-29.54-51.06-70.44-51.06-101.8 0 0-33.33 54.13-44.86 52.74-5.37-.65-12.42-29.64 9.347-99.7 10.26-33.02 21.1-60.48 40.14-105.8C60.68 98.06 108.1 .006 224 0c113.7 .006 163.2 96.13 160.3 214.1 18.12 45.22 29.91 72.85 40.14 105.8 21.77 70.06 14.72 99.05 9.346 99.7z"></path></svg></span><span><a href="mailto:k1664032884@gmail.com"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 352c-16.53 0-33.06-5.422-47.16-16.41L0 173.2V400C0 426.5 21.49 448 48 448h416c26.51 0 48-21.49 48-48V173.2l-208.8 162.5C289.1 346.6 272.5 352 256 352zM16.29 145.3l212.2 165.1c16.19 12.6 38.87 12.6 55.06 0l212.2-165.1C505.1 137.3 512 125 512 112C512 85.49 490.5 64 464 64h-416C21.49 64 0 85.49 0 112C0 125 6.01 137.3 16.29 145.3z"></path></svg></a></span><span><a href="https://github.com/kqhasaki" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></span><span><a href="/static/resume-ef27ab676ea536646634203d2696b372.pdf" download="resume.pdf" title="ç®€å†ä¸‹è½½"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file" class="svg-inline--fa fa-file " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M256 0v128h128L256 0zM224 128L224 0H48C21.49 0 0 21.49 0 48v416C0 490.5 21.49 512 48 512h288c26.51 0 48-21.49 48-48V160h-127.1C238.3 160 224 145.7 224 128z"></path></svg></a></span><span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sun" class="svg-inline--fa fa-sun " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"></path></svg></span></p><p>CopyRight Â© 2022 Louis K</p></div><div class="wrapper" style="align-items:flex-end"><h3>Links</h3><ul><li><span><a href="https://reactjs.org/" rel="noreferrer" target="_blank">React</a></span></li><li><span><a href="https://developer.mozilla.org/zh-CN/" rel="noreferrer" target="_blank">MDN</a></span></li><li><span><a href="https://leafletjs.com/reference.html" rel="noreferrer" target="_blank">Leaflet</a></span></li><li><span><a href="https://ant.design/index-cn" rel="noreferrer" target="_blank">Ant Design</a></span></li><li><span><a href="https://webpack.docschina.org/concepts/" rel="noreferrer" target="_blank">webpack</a></span></li></ul></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/articles/redbook-series/redbook-chapter20/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-a6a9e8476add1045c345.js"],"app":["/app-e932af7f93db5f1d5fc7.js"],"component---src-pages-404-js":["/component---src-pages-404-js-0596c1b54a96191bcb2c.js"],"component---src-pages-articles-mdx-slug-js":["/component---src-pages-articles-mdx-slug-js-9153719145713b5d4a70.js"],"component---src-pages-index-js":["/component---src-pages-index-js-d1c8fd647f7227c1623c.js"],"component---src-pages-non-tech-js":["/component---src-pages-non-tech-js-f008706b4b33f800b86e.js"]};/*]]>*/</script><script src="/polyfill-a6a9e8476add1045c345.js" nomodule=""></script><script src="/component---src-pages-articles-mdx-slug-js-9153719145713b5d4a70.js" async=""></script><script src="/commons-9cb01ae01e0bbefcc23a.js" async=""></script><script src="/a9a7754c-992c6b2080a7db331a45.js" async=""></script><script src="/cb1608f2-31c90b1bb67e245cb538.js" async=""></script><script src="/app-e932af7f93db5f1d5fc7.js" async=""></script><script src="/framework-f27b074ecebec0f1dbc4.js" async=""></script><script src="/webpack-runtime-2728ac9e468d19f28ba9.js" async=""></script></body></html>